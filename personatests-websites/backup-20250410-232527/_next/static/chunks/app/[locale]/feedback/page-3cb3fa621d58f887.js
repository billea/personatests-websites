(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{134:(e,t,s)=>{Promise.resolve().then(s.bind(s,4367))},4367:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var i=s(5155),a=s(5695),r=s(2115),l=s(7550),n=s(3722);function d(){let{t:e,currentLanguage:t}=(0,l.B)(),s=(0,a.useSearchParams)(),d=s.get("invitationId")||"",c=s.get("token")||"",o="ko"===t,[m,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[b,f]=(0,r.useState)(!0),[g,p]=(0,r.useState)(null),[N,j]=(0,r.useState)(0),[w,v]=(0,r.useState)({}),[y,k]=(0,r.useState)(!1),[S,I]=(0,r.useState)(!1);(0,r.useEffect)(()=>{_()},[d,c]);let _=async()=>{try{let e=s.get("name"),t=s.get("testId"),i=s.get("testResultId"),a=s.get("email");if(!e||!t||!i||!a||!c||!d){p("Invalid invitation link - missing parameters"),f(!1);return}if(JSON.parse(localStorage.getItem("submitted_feedback")||"[]").some(e=>e.invitationId===d)){p("This feedback has already been submitted"),f(!1);return}let r={id:d,inviterName:e,testId:t,testResultId:i,participantEmail:a,status:"pending",invitationToken:c};u(r);let l=(0,n.tb)(r.testId);l?x(l):p("Test not found")}catch(e){p("Failed to load invitation")}finally{f(!1)}},P=e=>{if(!h)return;let t=h.questions[N],s={...w,[t.id]:e};v(s),N<h.questions.length-1?j(N+1):R(s)},R=async e=>{if(m&&h){k(!0);try{let t=h.scoring(e),s={invitationId:d,testId:m.testId,testResultId:m.testResultId,answers:e,result:t,submittedAt:new Date().toISOString(),aboutPerson:m.inviterName,token:c},i=JSON.parse(localStorage.getItem("submitted_feedback")||"[]");i.push(s),localStorage.setItem("submitted_feedback",JSON.stringify(i));let a="aggregated_feedback_"+m.testResultId,r=JSON.parse(localStorage.getItem(a)||"[]");r.push({result:t,submittedAt:s.submittedAt,feedbackId:d}),localStorage.setItem(a,JSON.stringify(r)),I(!0)}catch(e){p("Failed to submit feedback. Please try again.")}finally{k(!1)}}};if(b)return(0,i.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-lg",children:"Loading..."})]})});if(g)return(0,i.jsx)("main",{className:"flex min-h-screen items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"text-center max-w-md",children:[(0,i.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Error"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:g}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"If you think this is a mistake, please contact the person who sent you this link."})]})});if(S)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsx)("div",{className:"w-full max-w-4xl",children:(0,i.jsxs)("div",{className:"text-center mb-8 p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg",children:[(0,i.jsx)("div",{className:"text-green-400 text-6xl mb-6",children:"✅"}),(0,i.jsx)("h1",{className:"text-4xl font-bold mb-4 text-white",children:o?"감사합니다!":"Thank You!"}),(0,i.jsx)("p",{className:"text-lg text-white/90 mb-6",children:o?((null==m?void 0:m.inviterName)||"")+"님을 위한 피드백이 성공적으로 제출되었습니다.":"Your feedback for "+((null==m?void 0:m.inviterName)||"")+" has been successfully submitted."})]})})});if(y)return(0,i.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-green-500 mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-lg",children:"Submitting..."})]})});if(!h||!m)return(0,i.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,i.jsx)("p",{children:"Loading..."})});let q=h.questions[N];return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"w-full max-w-3xl",children:[(0,i.jsxs)("div",{className:"mb-8 text-center",children:[(0,i.jsxs)("div",{className:"mb-6 p-6 bg-gradient-to-br from-purple-500/30 to-pink-500/30 border border-purple-400/50 rounded-lg",children:[(0,i.jsxs)("h1",{className:"text-2xl font-bold text-white mb-4 text-center",children:["\uD83C\uDFAF ",o?"피드백 요청":"Feedback Request"]}),(0,i.jsx)("p",{className:"text-white/90 mb-6 text-lg text-center",children:o?m.inviterName+"님이 피드백을 요청했습니다":m.inviterName+" has asked for your feedback"})]}),(0,i.jsx)("div",{className:"w-full bg-white/20 backdrop-blur-sm rounded-full h-3 mb-2",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-yellow-300 to-orange-400 h-3 rounded-full transition-all duration-500",style:{width:(N+1)/h.questions.length*100+"%"}})}),(0,i.jsxs)("p",{className:"text-white/80 text-sm",children:["Question ",N+1," of ",h.questions.length]})]}),(0,i.jsxs)("div",{className:"p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg",children:[(0,i.jsx)("h2",{className:"mb-6 text-xl font-semibold tracking-tight text-white",children:e(q.text_key)||q.text_key}),(0,i.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 mb-6 border border-white/20",children:(0,i.jsx)("p",{className:"text-sm text-white/90 font-medium",children:o?"이 질문에 답할 때 "+m.inviterName+"님을 생각해 주세요.":"Think about "+m.inviterName+" when answering this question."})}),"multiple_choice"===q.type&&q.options&&(0,i.jsx)("div",{className:"flex flex-col gap-3",children:q.options.map((t,s)=>(0,i.jsx)("button",{onClick:()=>P(t.value),className:"w-full p-4 text-left bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg hover:bg-white/30 transition-all duration-300 transform hover:scale-105 text-white",children:e(t.text_key)||t.text_key},s))}),"scale"===q.type&&q.scale&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm text-white/80",children:[(0,i.jsx)("span",{children:o?"전혀 그렇지 않다":"Not at all"}),(0,i.jsx)("span",{children:o?"매우 그렇다":"Always"})]}),(0,i.jsx)("div",{className:"flex justify-between gap-2",children:Array.from({length:q.scale.max-q.scale.min+1},(e,t)=>{let s=q.scale.min+t;return(0,i.jsx)("button",{onClick:()=>P(s),className:"flex-1 py-3 text-center bg-white/20 backdrop-blur-sm border border-white/30 rounded hover:bg-white/30 hover:scale-105 transition-all duration-300 text-white font-semibold",children:s},s)})})]})]}),(0,i.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,i.jsx)("div",{className:"flex gap-3",children:N>0&&(0,i.jsxs)("button",{onClick:()=>{N>0&&j(N-1)},className:"px-4 py-2 bg-white/10 backdrop-blur-sm border border-white/30 text-white rounded-lg hover:bg-white/20 transition-all duration-300",children:["← ",o?"이전":"Previous"]})}),(0,i.jsxs)("div",{className:"text-white/80 text-sm",children:["Question ",N+1," of ",h.questions.length]}),(0,i.jsx)("div",{className:"w-20"})]}),(0,i.jsxs)("div",{className:"mt-8 text-center bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[(0,i.jsxs)("div",{className:"flex items-center justify-center mb-3",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-500/80 flex items-center justify-center mr-3",children:(0,i.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDD12"})}),(0,i.jsx)("p",{className:"text-sm font-semibold text-white",children:o?"100% 익명 보장":"100% Anonymous Guarantee"})]}),(0,i.jsx)("p",{className:"text-sm text-white/80 leading-relaxed max-w-2xl mx-auto",children:o?"이 피드백은 완전히 익명입니다. "+m.inviterName+"님은 종합 결과만 볼 수 있으며 개별 응답이나 응답자가 누구인지는 알 수 없습니다.":"This feedback is completely anonymous. "+m.inviterName+" will see aggregated results but not individual responses or who provided them."})]})]})})}},5695:(e,t,s)=>{"use strict";var i=s(8999);s.o(i,"useParams")&&s.d(t,{useParams:function(){return i.useParams}}),s.o(i,"usePathname")&&s.d(t,{usePathname:function(){return i.usePathname}}),s.o(i,"useRouter")&&s.d(t,{useRouter:function(){return i.useRouter}}),s.o(i,"useSearchParams")&&s.d(t,{useSearchParams:function(){return i.useSearchParams}})}},e=>{e.O(0,[550,722,441,964,358],()=>e(e.s=134)),_N_E=e.O()}]);