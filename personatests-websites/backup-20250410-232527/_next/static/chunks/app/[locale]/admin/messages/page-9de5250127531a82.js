(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[438],{2156:(e,s,a)=>{Promise.resolve().then(a.bind(a,8512))},5695:(e,s,a)=>{"use strict";var t=a(8999);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},7200:(e,s,a)=>{"use strict";a.d(s,{A:()=>o,AuthProvider:()=>m});var t=a(5155),r=a(2115),l=a(5404),i=a(5695),n=a(6104),d=a(9086);let c=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},m=e=>{let{children:s}=e,[a,o]=(0,r.useState)(null),[m,u]=(0,r.useState)(!0),g=(0,i.useRouter)();return(0,r.useEffect)(()=>{let e=(0,l.hg)(n.j,async e=>{if(e){if(!e.providerData.some(e=>"google.com"===e.providerId)&&!e.emailVerified){console.log("\uD83D\uDEA8 AuthProvider: Blocking unverified email user:",e.email),console.log("\uD83D\uDCE7 Email verification status:",e.emailVerified),await (0,l.CI)(n.j),o(null),u(!1);return}console.log("âœ… AuthProvider: User verified, proceeding:",e.email);try{await (0,d.sM)(e)}catch(e){console.warn("Firebase permissions issue - continuing without profile creation:",e)}if(!a&&e){let s=localStorage.getItem("auth_return_url"),a=localStorage.getItem("auth_return_context");if(s&&("feedback-360-test"===a||"couple-compatibility-test"===a)){localStorage.removeItem("auth_return_url"),localStorage.removeItem("auth_return_context"),console.log("User logged in, preparing greeting before ".concat(a));let t=s.match(/\/([a-z]{2})\//),r=t?t[1]:"en";setTimeout(()=>{g.push("/".concat(r,"/welcome?returnUrl=").concat(encodeURIComponent(s),"&context=").concat(a,"&userName=").concat(encodeURIComponent(e.displayName||e.email||"User")))},100)}}}o(e),u(!1)});return()=>e()},[a,g]),(0,t.jsx)(c.Provider,{value:{user:a,loading:m},children:!m&&s})}},8512:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var t=a(5155),r=a(2115),l=a(7550),i=a(7200),n=a(9086);function d(){let{t:e,currentLanguage:s}=(0,l.B)(),{user:a,loading:d}=(0,i.A)(),[c,o]=(0,r.useState)([]),[m,u]=(0,r.useState)(!0),[g,x]=(0,r.useState)("all"),[h,p]=(0,r.useState)("all"),[v,b]=(0,r.useState)(""),[y,f]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1),[w,S]=(0,r.useState)(""),[C,_]=(0,r.useState)(!1),[k,A]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{if(a&&!d)try{let e=await (0,n.N6)(a.uid);_(e),e&&P()}catch(e){console.error("Error checking admin role:",e),_(!1)}A(!1)})()},[a,d]);let P=async()=>{try{u(!0);let e=await (0,n.Kv)();o(e)}catch(e){console.error("Error loading messages:",e)}finally{u(!1)}},E=async(e,s,a)=>{try{N(!0),await (0,n.FQ)(e,s,a),await P(),f(null),S("")}catch(e){console.error("Error updating message status:",e)}finally{N(!1)}},L=async s=>{if(window.confirm(e("admin.messages.confirm_delete")||"Are you sure you want to delete this message?"))try{await (0,n.P7)(s),await P(),f(null)}catch(e){console.error("Error deleting message:",e)}},R=c.filter(e=>{let s="all"===g||e.status===g,a="all"===h||e.category===h,t=""===v||e.name.toLowerCase().includes(v.toLowerCase())||e.email.toLowerCase().includes(v.toLowerCase())||e.subject.toLowerCase().includes(v.toLowerCase())||e.message.toLowerCase().includes(v.toLowerCase());return s&&a&&t}),D=e=>{switch(e){case"new":return"bg-red-100 text-red-800";case"read":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},I=e=>{switch(e){case"general":return"bg-blue-100 text-blue-800";case"technical":return"bg-purple-100 text-purple-800";case"feedback":return"bg-green-100 text-green-800";case"partnership":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},U=e=>{if(!e)return"";let s=e.toDate?e.toDate():new Date(e);return s.toLocaleDateString()+" "+s.toLocaleTimeString()};return d||k?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):a?C?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("admin.messages.title")||"Contact Messages"}),(0,t.jsx)("p",{className:"text-gray-600",children:e("admin.messages.subtitle")||"Manage and respond to user inquiries"})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("admin.messages.search")||"Search"}),(0,t.jsx)("input",{type:"text",value:v,onChange:e=>b(e.target.value),placeholder:e("admin.messages.search_placeholder")||"Search messages...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("admin.messages.status")||"Status"}),(0,t.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,t.jsx)("option",{value:"all",children:e("admin.messages.all_statuses")||"All Statuses"}),(0,t.jsx)("option",{value:"new",children:e("admin.messages.new")||"New"}),(0,t.jsx)("option",{value:"read",children:e("admin.messages.read")||"Read"}),(0,t.jsx)("option",{value:"resolved",children:e("admin.messages.resolved")||"Resolved"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("admin.messages.category")||"Category"}),(0,t.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,t.jsx)("option",{value:"all",children:e("admin.messages.all_categories")||"All Categories"}),(0,t.jsx)("option",{value:"general",children:e("contact.form.category_general")||"General Inquiry"}),(0,t.jsx)("option",{value:"technical",children:e("contact.form.category_technical")||"Technical Issue"}),(0,t.jsx)("option",{value:"feedback",children:e("contact.form.category_feedback")||"Feedback & Suggestions"}),(0,t.jsx)("option",{value:"partnership",children:e("contact.form.category_partnership")||"Partnership"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e("admin.messages.total")||"Total",": ",c.length]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e("admin.messages.filtered")||"Filtered",": ",R.length]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:e("admin.messages.messages_list")||"Messages"})}),m?(0,t.jsx)("div",{className:"p-8 text-center text-gray-600",children:e("admin.messages.loading")||"Loading messages..."}):0===R.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-600",children:e("admin.messages.no_messages")||"No messages found"}):(0,t.jsx)("div",{className:"divide-y",children:R.map(e=>(0,t.jsxs)("div",{onClick:()=>f(e),className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors ".concat((null==y?void 0:y.id)===e.id?"bg-purple-50 border-l-4 border-l-purple-500":""),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(D(e.status)),children:e.status}),(0,t.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(I(e.category)),children:e.category})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:U(e.createdAt)})]}),(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e.email})]}),(0,t.jsx)("div",{className:"font-medium text-gray-900 mb-1",children:e.subject}),(0,t.jsx)("div",{className:"text-sm text-gray-600 line-clamp-2",children:e.message})]},e.id))})]})}),(0,t.jsx)("div",{className:"lg:col-span-1",children:y?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:e("admin.messages.message_details")||"Message Details"})}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("span",{className:"px-3 py-1 text-sm font-medium rounded-full ".concat(D(y.status)),children:y.status}),(0,t.jsx)("span",{className:"px-3 py-1 text-sm font-medium rounded-full ".concat(I(y.category)),children:y.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:y.name}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:y.email}),y.userEmail&&y.userEmail!==y.email&&(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["User: ",y.userEmail]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,t.jsx)("div",{className:"text-gray-900",children:y.subject})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,t.jsx)("div",{className:"text-gray-900 bg-gray-50 p-3 rounded text-sm whitespace-pre-wrap",children:y.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Admin Notes"}),(0,t.jsx)("textarea",{value:w||y.adminNotes||"",onChange:e=>S(e.target.value),placeholder:"Add admin notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm",rows:3})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsxs)("div",{children:["Created: ",U(y.createdAt)]}),y.readAt&&(0,t.jsxs)("div",{children:["Read: ",U(y.readAt)]}),y.resolvedAt&&(0,t.jsxs)("div",{children:["Resolved: ",U(y.resolvedAt)]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2 pt-4 border-t",children:["new"===y.status&&(0,t.jsx)("button",{onClick:()=>E(y.id,"read",w),disabled:j,className:"w-full px-3 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:opacity-50 text-sm",children:j?"Updating...":"Mark as Read"}),("new"===y.status||"read"===y.status)&&(0,t.jsx)("button",{onClick:()=>E(y.id,"resolved",w),disabled:j,className:"w-full px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 text-sm",children:j?"Updating...":"Mark as Resolved"}),w&&w!==y.adminNotes&&(0,t.jsx)("button",{onClick:()=>E(y.id,y.status,w),disabled:j,className:"w-full px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:j?"Updating...":"Save Notes"}),(0,t.jsx)("button",{onClick:()=>L(y.id),className:"w-full px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm",children:"Delete Message"})]})]})]}):(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-8 text-center text-gray-500",children:e("admin.messages.select_message")||"Select a message to view details"})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-sm border max-w-md w-full text-center",children:[(0,t.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:e("admin.access.denied")||"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:e("admin.access.admin_only")||"You need administrator privileges to access this page."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-600",children:"Please sign in to access admin features."})})}}},e=>{e.O(0,[135,965,155,761,550,86,441,964,358],()=>e(e.s=2156)),_N_E=e.O()}]);