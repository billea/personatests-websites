"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{6104:(e,t,o)=>{o.d(t,{firestore:()=>i,j:()=>c});var n=o(3915),a=o(5404),r=o(5317);let s=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyDrIchldLRg4rsPVsmSDWIDDnBbYIjdClo",authDomain:"personatest-c8eb1.firebaseapp.com",projectId:"personatest-c8eb1",storageBucket:"personatest-c8eb1.firebasestorage.app",messagingSenderId:"56769105558",appId:"1:56769105558:web:8e13f979f8b7541ec5fcb7"}),i=(0,r.aU)(s),c=(0,a.xI)(s)},9086:(e,t,o)=>{o.d(t,{Af:()=>g,Bs:()=>m,C3:()=>Z,CV:()=>z,FQ:()=>W,Gb:()=>v,J1:()=>L,J7:()=>K,K4:()=>M,KG:()=>S,Kv:()=>V,MC:()=>k,N6:()=>$,OR:()=>q,P7:()=>X,Rh:()=>O,Yd:()=>H,bE:()=>J,cp:()=>en,cs:()=>j,eg:()=>eo,g3:()=>N,getCoupleCompatibilityResultsByEmail:()=>f,getRandomGeneralKnowledgeQuestions:()=>_,getRandomGeneralKnowledgeQuestionsWithAnswers:()=>D,getRandomMathSpeedQuestions:()=>I,getRandomMemoryPowerQuestions:()=>A,getRandomMemoryPowerQuestionsWithAnswers:()=>P,iZ:()=>u,jI:()=>T,jb:()=>y,ji:()=>B,m6:()=>ee,mc:()=>x,nI:()=>l,pO:()=>c,rc:()=>et,sM:()=>i,sendCoupleCompatibilityInvitation:()=>d,v4:()=>Y,ys:()=>F,zG:()=>b});var n=o(5317),a=o(6104),r=o(7548),s=o(9509);(0,r.Uz)();let i=async e=>{if(e)try{let t=(0,n.H9)(a.firestore,"users",e.uid);if(!(await (0,n.x7)(t)).exists()){let{email:o,displayName:a,uid:r}=e,s=(0,n.O5)();try{await (0,n.BN)(t,{uid:r,email:o,displayName:a,createdAt:s,preferredLanguage:navigator.language.split("-")[0]||"en"}),console.log("User profile created successfully")}catch(e){throw console.error("Error creating user profile:",e),e}}}catch(e){throw console.error("Error accessing user profile:",e),e}},c=async function(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{let s={userId:e,testId:t,resultPayload:o,isPublic:r,createdAt:(0,n.O5)()},i=await (0,n.gS)((0,n.collection)(a.firestore,"testResults"),s);return console.log("Test result saved with ID:",i.id),i.id}catch(t){console.error("Firebase permissions error - test result not saved to Firestore:",t);let e="local_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15));return console.log("Using local storage fallback with ID:",e),e}},l=async(e,t)=>{try{console.log("\uD83D\uDD04 Transferring anonymous results for test type:",t);let o=null,n=0,a="";console.log("\uD83D\uDD0D Scanning localStorage for test results. Total items:",localStorage.length);for(let e=0;e<localStorage.length;e++){let r=localStorage.key(e);if(null==r?void 0:r.startsWith("test_result_"))try{let e=localStorage.getItem(r);if(e){let s=JSON.parse(e);console.log("\uD83D\uDD0D Found localStorage result:",{key:r,testId:s.testId,completedAt:s.completedAt,hasResult:!!s.result});let i=s.completedAt?new Date(s.completedAt).getTime():s.timestamp||0;s.testId===t&&i>n&&(console.log("✅ This is the most recent result for test type:",t),o=s,n=i,a=r)}}catch(e){console.error("Error parsing localStorage result:",e)}}if(!o)return console.log("❌ No anonymous results found for test type:",t),!1;console.log("✅ Found anonymous result to transfer:",o);let r=await c(e,t,o,!1);return console.log("✅ Successfully transferred result to authenticated account with ID:",r),localStorage.setItem("test_result_".concat(r),JSON.stringify(o)),localStorage.removeItem(a),localStorage.removeItem("preserve_test_result"),!0}catch(e){return console.error("❌ Error transferring anonymous results:",e),!1}},u=async e=>{try{let t=(0,n.query)((0,n.collection)(a.firestore,"testResults"),(0,n.where)("userId","==",e),(0,n.My)("createdAt","desc")),o=await (0,n.getDocs)(t),r=[];return o.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){var t;return console.error("Error getting user test results:",e),(null==e?void 0:e.code)==="failed-precondition"&&(null==e||null==(t=e.message)?void 0:t.includes("index"))&&console.warn("Firestore index missing for getUserTestResults - returning empty results to prevent infinite loops"),[]}},d=async function(e,t,r,i){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"en",l=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0;try{let d=Math.random().toString(36).substring(2,15);console.log("\uD83D\uDE80 [".concat(d,"] sendCoupleCompatibilityInvitation called with:"),{userId:e,testResultId:t,partnerEmail:r,userName:i,language:c,ownerEmail:l,partnerName:u,timestamp:new Date().toISOString()});let g=h(),m="couple_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15)),p={inviterUserId:e,participantEmail:r,testId:"couple-compatibility",testResultId:t,token:g,status:"pending",inviterName:i,feedbackCategory:"couple",createdAt:(0,n.O5)(),language:c};try{let e=await (0,n.gS)((0,n.collection)(a.firestore,"invitations"),p);console.log("Couple compatibility invitation created with ID:",e.id)}catch(e){console.warn("Firebase permissions - storing invitation in localStorage:",e),localStorage.setItem("invitation_".concat(m),JSON.stringify({...p,createdAt:new Date().toISOString()}))}let y="".concat("https://korean-mbti-platform.netlify.app","/").concat(c,"/tests/couple-compatibility?invitation=").concat(m,"&token=").concat(encodeURIComponent(g),"&partner=").concat(encodeURIComponent(i),"&testResultId=").concat(encodeURIComponent(t),"&email=").concat(encodeURIComponent(r),"&inviterEmail=").concat(encodeURIComponent(l||"unknown@example.com"));console.log("Generated couple compatibility invitation URL:",y);try{let e=(await o.e(518).then(o.bind(o,5518))).default,t=(null==u?void 0:u.trim())||r.split("@")[0],n={to_email:r,email:r,recipient_email:r,to_name:t,name:t,recipient_name:t,from_name:i,sender_name:i,invitation_link:y,link:y,message:"".concat(i," has invited you to take a Couple Compatibility Test together. Discover how compatible you are as a couple! This fun test analyzes your relationship compatibility across key areas like communication, lifestyle, and values."),time_estimate:"5-10 minutes",additional_info:"Your answers will be combined with your partner's to create a compatibility report for both of you."},a=s.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID||"",c="template_m5atn39",l=s.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY||"";console.log("=== [".concat(d,"] COUPLE COMPATIBILITY EMAILJS DEBUG ===")),console.log("Service ID:",a),console.log("Template ID:",c),console.log("Public Key:",l?"".concat(l.substring(0,8),"..."):"MISSING"),console.log("EmailJS parameters:",n),console.log("Full invitation link being sent:",y),console.log("Link length:",y.length),console.log("Partner email:",r),console.log("User name:",i),console.log("Partner name (input):",u),console.log("Recipient name (computed):",t),console.log("=== [".concat(d,"] ATTEMPTING EMAILJS SEND ==="));let g=await e.send(a,c,n,l);console.log("✅ [".concat(d,"] EMAIL SENT SUCCESSFULLY:"),g),console.log("Response status:",g.status),console.log("Response text:",g.text)}catch(e){console.warn("Email sending failed - invitation link can be shared manually:",e)}return{success:!0,invitationsSent:1,invitations:[{email:r,link:y}],message:"Couple compatibility invitation sent successfully!"}}catch(e){return console.error("❌ ERROR SENDING COUPLE COMPATIBILITY INVITATION:",e),console.error("Error details:",{message:e instanceof Error?e.message:"Unknown error",stack:e instanceof Error?e.stack:"No stack trace",name:e instanceof Error?e.name:"Unknown error type"}),{success:!0,invitationsSent:1,invitations:[{email:r,link:"https://korean-mbti-platform.netlify.app/".concat(c,"/tests/couple-compatibility?partner=").concat(encodeURIComponent(i))}],message:"Link generated for manual sharing (email service unavailable)"}}},g=async function(e,t,r,i,c,l){let u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"en",d=arguments.length>7?arguments[7]:void 0;try{console.log("sendFeedbackInvitations called with:",{userId:e,testId:t,testResultId:r,participants:i,userName:c,feedbackCategory:l,language:u,ownerEmail:d});let g=i.map(e=>({id:"invite_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15)),email:e.email,name:e.name,testId:t,testResultId:r,userName:c,ownerEmail:d||"durha2000@gmail.com",invitationToken:h(),createdAt:new Date().toISOString(),status:"pending"})),m=[];try{let o=g.map(async o=>{let s={inviterUid:e,inviterName:c,testId:t,testResultId:r,participantEmail:o.email,status:"pending",invitationToken:o.invitationToken,feedbackCategory:l},i=await (0,n.gS)((0,n.collection)(a.firestore,"testInvitations"),{...s,createdAt:(0,n.O5)()});return{...o,firestoreId:i.id}});m=await Promise.all(o),console.log("Invitations saved to Firestore successfully:",m.length);try{await w(e,r,t,i.length,m.map(e=>e.id),l)}catch(e){console.warn("Failed to update feedback progress, but continuing with invitation generation:",e)}}catch(e){console.warn("Firebase permissions error - using fallback invitation storage:",e),m=g}try{localStorage.setItem("feedback_invitations",JSON.stringify(g)),console.log("Invitations stored in localStorage:",g.length)}catch(e){console.error("Failed to store invitations in localStorage:",e)}let p=window.location.origin;console.log("Creating feedback links with language:",u);let y=g.map(e=>{let o=new URLSearchParams({token:e.invitationToken,name:c,testId:t,testResultId:r,email:e.email}),n="".concat(p,"/").concat(u,"/feedback?invitationId=").concat(e.id,"&").concat(o.toString());return console.log("Generated URL for ".concat(e.email,":")),console.log("Length: ".concat(n.length," characters")),console.log("URL: ".concat(n)),{email:e.email,link:n}});console.log("Feedback invitation links generated:"),y.forEach(e=>{console.log("".concat(e.email,": ").concat(e.link))});try{let e=(await o.e(518).then(o.bind(o,5518))).default,t=y.map(async(t,o)=>{let n=g[o].name||t.email.split("@")[0],a={work:"ko"===u?"직장 동료":"Work Colleagues",friends:"ko"===u?"친구":"Friends",family:"ko"===u?"가족":"Family",academic:"ko"===u?"학업 파트너":"Academic Partners",general:"ko"===u?"일반 관계":"General Relationships"}[l]||("ko"===u?"360도 피드백":"360\xb0 Feedback"),r={to_email:t.email,email:t.email,recipient_email:t.email,to_name:n,name:n,recipient_name:n,from_name:c,sender_name:c,invitation_link:t.link,link:t.link,test_title:"ko"===u?"\uD83C\uDFAF 360도 피드백 평가":"\uD83C\uDFAF 360\xb0 Feedback Assessment",header_title:"ko"===u?"360도 피드백 평가":"360\xb0 Feedback Assessment",header_subtitle:"ko"===u?"다각도 성격 통찰력 제공하기":"Help Provide Multi-Perspective Personality Insights",greeting:"ko"===u?"안녕하세요 ".concat(n,"님!"):"Hello ".concat(n,"!"),invitation_message:"ko"===u?"".concat(c,"님이 360도 피드백 평가에 참여해 달라고 요청했습니다."):"".concat(c," has requested your participation in a 360\xb0 feedback assessment."),description:"ko"===u?"이 흥미롭고 통찰력 있는 평가는 ".concat(c,"님이 다음을 발견할 수 있도록 도와줍니다:"):"This insightful and valuable assessment will help ".concat(c," discover:"),benefits:"ko"===u?"\uD83C\uDFAF 리더십과 의사소통 능력에 대한 피드백\n\uD83D\uDCAC 팀워크와 협업 스타일 평가\n\uD83E\uDDE0 감정 지능과 대인관계 기술 분석\n⭐ 개인적, 전문적 성장을 위한 통찰력":"\uD83C\uDFAF Your valuable insights into ".concat(c,"'s leadership and communication\n\uD83D\uDCAC Assessment of teamwork and collaboration style\n\uD83E\uDDE0 Analysis of emotional intelligence and interpersonal skills\n⭐ Professional growth insights from multiple perspectives"),detailed_description:"ko"===u?"".concat(c,"님이 전문적으로 성장하는 데 필요한 360도 피드백 평가에 참여해 달라는 요청을 받았습니다. 여러분의 응답은 완전히 익명으로 처리되며 ").concat(c,"님의 성장에 도움이 될 것입니다."):"".concat(c," has requested your participation in a 360\xb0 feedback assessment. You'll evaluate areas like leadership, communication, teamwork, and emotional intelligence. Your responses are completely anonymous and will help ").concat(c," grow professionally."),cta_text:"ko"===u?"피드백 제공하기":"Provide Feedback",time_estimate:"ko"===u?"소요 시간: 5-10분":"Time Required: 5-10 minutes",footer_message:"ko"===u?"".concat(a," 관점에서 ").concat(c,"님에 대한 질문에 답해주세요."):"Please answer questions about ".concat(c," from your perspective as ").concat(a.toLowerCase(),"."),privacy_note:"ko"===u?"개인정보 보호: 귀하의 개별 답변은 비공개로 유지되며 결합된 피드백 결과만 공유됩니다.":"Privacy: Your individual answers remain private - only the combined feedback results are shared.",template_type:"gradient_design",primary_color:"#6366f1",secondary_color:"#8b5cf6",emoji_icon:"\uD83C\uDFAF"};console.log("Sending 360 feedback invitation email to: ".concat(t.email)),console.log("Email parameters:",r);let i=s.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID||"",d="template_ftlg4we",m=s.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY||"";console.log("Using EmailJS template: ".concat(d," for 360 feedback invitation"));try{let o=await e.send(i,d,r,m);return console.log("✅ 360 feedback invitation sent to ".concat(t.email,":"),o),{email:t.email,status:"sent",response:o}}catch(e){return console.warn("⚠️ Email failed for ".concat(t.email,", but link still available:"),e),{email:t.email,status:"link_only",error:e}}}),n=await Promise.all(t),a=n.filter(e=>"sent"===e.status).length;console.log("\uD83D\uDCE7 360 Feedback email invitations: ".concat(a,"/").concat(n.length," sent successfully"))}catch(e){console.warn("EmailJS not available for 360 feedback invitations, using link sharing only:",e)}return{success:!0,invitationsSent:g.length,invitations:y,message:"360\xb0 Feedback invitations sent via email! Recipients will receive beautifully designed invitations with direct links to provide their feedback."}}catch(n){console.error("Error generating feedback invitations:",n);let e=window.location.origin,o=i.map(o=>{let n="".concat(e,"/").concat(u,"/feedback?email=").concat(encodeURIComponent(o.email),"&name=").concat(encodeURIComponent(c),"&testId=").concat(encodeURIComponent(t));return{email:o.email,link:n}});return{success:!0,invitationsSent:i.length,invitations:o,message:"Feedback invitations ready! If emails failed to send automatically, you can share these links manually with your reviewers."}}},m=async function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en";try{var c,l,u,d,g,m,y,f,h;let w=(await o.e(518).then(o.bind(o,5518))).default,v=e.compatibilityPercentage||75,k=p(v),b="https://korean-mbti-platform.netlify.app",_="".concat(b,"/").concat(i,"/auth?action=signup&redirect=").concat(encodeURIComponent("/".concat(i,"/results")),"&partner=").concat(encodeURIComponent(r),"&source=couple-email"),D="".concat(b,"/").concat(i,"/auth?action=signup&redirect=").concat(encodeURIComponent("/".concat(i,"/results")),"&partner=").concat(encodeURIComponent(a),"&source=couple-email"),E=e.areaBreakdown||e.areaScores||(null==(c=e.compatibilityData)?void 0:c.areaScores)||{},q=e=>{let t="ko"===i?{"Fun & Lifestyle":"재미 & 라이프스타일","Values & Trust":"가치관 & 신뢰",Communication:"의사소통","Lifestyle Habits":"생활 습관","Romance & Love":"로맨스 & 사랑"}:{"Fun & Lifestyle":"Fun & Lifestyle","Values & Trust":"Values & Trust",Communication:"Communication","Lifestyle Habits":"Lifestyle Habits","Romance & Love":"Romance & Love"};return Object.entries(e).map(e=>{let[o,n]=e,a=t[o]||o;return"".concat(a,": ").concat(n,"%")}).join("\n")},S=q(E),I=Object.keys(E).length>0?S:"ko"===i?"상세한 영역별 분석을 보려면 가입하세요!":"Sign up to see detailed area analysis!",C={to_email:t,email:t,recipient_email:t,to_name:a,partner_name:r,compatibility_percentage:v+"%",compatibility_tier:k,partner1_type:(null==(l=e.partner1)?void 0:l.type)||"Your Personality Type",partner2_type:(null==(u=e.partner2)?void 0:u.type)||"Partner Personality Type",description:e.description||"Great compatibility potential!",subject:"\uD83D\uDC95 Your Couple Compatibility Results with ".concat(r),test_name:"Couple Compatibility Test",invitation_link:"".concat(b,"/").concat(i,"/results"),area_breakdown:I,detailed_results:"\uD83D\uDC95 Couple Compatibility Results\n".concat(v,"%\n").concat(e.description||"You complement each other beautifully!","\n\n").concat(a,"\n").concat((null==(d=e.partner1)?void 0:d.type)||"The Devoted Partner \uD83D\uDC95","\n\n").concat(r,"\n").concat((null==(g=e.partner2)?void 0:g.type)||"The Devoted Partner \uD83D\uDC95","\n\nCompatibility Areas:\n").concat(I),signup_cta:"ko"===i?"".concat(r,"님과의 상세 호환성 분석을 확인하려면 무료 가입하세요!"):"Sign up free to unlock detailed compatibility analysis with ".concat(r,"!"),signup_url:_,signup_button_text:"ko"===i?"\uD83D\uDD0D 상세 비교 보기 (무료)":"\uD83D\uDD0D View Detailed Comparison (Free)",button_explanation:"ko"===i?"질문별 답변 비교, 심화 분석 및 관계 개선 팁을 확인하세요":"See question-by-question answers, in-depth analysis, and relationship tips",comparison_features:"ko"===i?"• 15개 질문별 답변 비교\n• 상세 호환성 분석 보고서\n• 관계 개선 제안사항\n• 결과 저장 및 재열람":"• Question-by-question answer comparison\n• Detailed compatibility report\n• Relationship improvement suggestions\n• Save results for future access"},A={to_email:n,email:n,recipient_email:n,to_name:r,partner_name:a,compatibility_percentage:v+"%",compatibility_tier:k,partner1_type:(null==(m=e.partner1)?void 0:m.type)||"Partner Personality Type",partner2_type:(null==(y=e.partner2)?void 0:y.type)||"Your Personality Type",description:e.description||"Great compatibility potential!",subject:"\uD83D\uDC95 Your Couple Compatibility Results with ".concat(a),test_name:"Couple Compatibility Test",invitation_link:"".concat(b,"/").concat(i,"/results"),area_breakdown:I,detailed_results:"\uD83D\uDC95 Couple Compatibility Results\n".concat(v,"%\n").concat(e.description||"You complement each other beautifully!","\n\n").concat(r,"\n").concat((null==(f=e.partner2)?void 0:f.type)||"The Devoted Partner \uD83D\uDC95","\n\n").concat(a,"\n").concat((null==(h=e.partner1)?void 0:h.type)||"The Devoted Partner \uD83D\uDC95","\n\nCompatibility Areas:\n").concat(I),signup_cta:"ko"===i?"".concat(a,"님과의 상세 호환성 분석을 확인하려면 무료 가입하세요!"):"Sign up free to unlock detailed compatibility analysis with ".concat(a,"!"),signup_url:D,signup_button_text:"ko"===i?"\uD83D\uDD0D 상세 비교 보기 (무료)":"\uD83D\uDD0D View Detailed Comparison (Free)",button_explanation:"ko"===i?"질문별 답변 비교, 심화 분석 및 관계 개선 팁을 확인하세요":"See question-by-question answers, in-depth analysis, and relationship tips",comparison_features:"ko"===i?"• 15개 질문별 답변 비교\n• 상세 호환성 분석 보고서\n• 관계 개선 제안사항\n• 결과 저장 및 재열람":"• Question-by-question answer comparison\n• Detailed compatibility report\n• Relationship improvement suggestions\n• Save results for future access"},P=s.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID||"",U="template_cqvgidu",x=s.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY||"";return console.log("\uD83D\uDD0D COUPLE RESULTS EMAIL DEBUG:"),console.log("- Service ID:",P),console.log("- Template ID (hardcoded):",U),console.log("- Sending to partner1:",t,"- partner2:",n),console.log("- Couple compatibility data structure:",e),console.log("- Area breakdown extracted:",E),console.log("- Area breakdown formatted:",q(E)),await Promise.all([w.send(P,U,C,x),w.send(P,U,A,x)]),console.log("Couple compatibility results sent to both partners successfully"),{success:!0}}catch(e){return console.error("Error sending couple compatibility results:",e),{success:!1,error:e}}},p=e=>e>=95?"Soulmates \uD83D\uDC8D":e>=85?"Power Couple ⚡":e>=75?"Adventurous Duo \uD83C\uDF0D":e>=65?"Sweet Match \uD83D\uDC95":e>=50?"Work in Progress \uD83D\uDD28":e>=35?"Learning Together \uD83D\uDCDA":"Opposites Attract \uD83E\uDD14",y=async e=>{try{let t=(0,n.H9)(a.firestore,"couple_results",e.searchKey);return await (0,n.BN)(t,{...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),console.log("✅ Couple compatibility result saved to couple_results collection"),{success:!0,id:e.searchKey}}catch(e){throw console.error("❌ Error saving couple compatibility result:",e),e}},f=async e=>{try{let t=(0,n.query)((0,n.collection)(a.firestore,"couple_results"),(0,n.where)("partner1Email","==",e)),o=(0,n.query)((0,n.collection)(a.firestore,"couple_results"),(0,n.where)("partner2Email","==",e)),[r,s]=await Promise.all([(0,n.getDocs)(t),(0,n.getDocs)(o)]),i=[];return r.forEach(e=>{let t=e.data();i.push({id:e.id,...t})}),s.forEach(e=>{let t=e.data();i.push({id:e.id,...t})}),i.filter((e,t,o)=>t===o.findIndex(t=>t.searchKey===e.searchKey))}catch(e){return[]}};function h(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}async function w(e,t,o,r,s,i){try{let c=(0,n.H9)(a.firestore,"feedbackProgress","".concat(e,"_").concat(t)),l=await (0,n.x7)(c);if(l.exists()){let e=l.data(),t={...e.categoryBreakdown};t[i]||(t[i]={sent:0,received:0,pending:[],completed:[]}),t[i].sent+=r,t[i].pending.push(...s),await (0,n.BN)(c,{...e,totalInvitationsSent:e.totalInvitationsSent+r,pendingInvitations:[...e.pendingInvitations,...s],categoryBreakdown:t,lastUpdated:(0,n.O5)()},{merge:!0})}else{let a={work:{sent:0,received:0,pending:[],completed:[]},friends:{sent:0,received:0,pending:[],completed:[]},family:{sent:0,received:0,pending:[],completed:[]},academic:{sent:0,received:0,pending:[],completed:[]},general:{sent:0,received:0,pending:[],completed:[]}};a[i]={sent:r,received:0,pending:s,completed:[]},await (0,n.BN)(c,{...{userId:e,testResultId:t,testId:o,totalInvitationsSent:r,feedbackReceived:0,pendingInvitations:s,completedInvitations:[],categoryBreakdown:a},lastUpdated:(0,n.O5)()})}console.log("Feedback progress updated successfully")}catch(e){throw console.error("Error updating feedback progress:",e),e}}let v=async e=>{try{let t=(0,n.query)((0,n.collection)(a.firestore,"invitations"),(0,n.where)("inviterUid","==",e),(0,n.where)("status","==","pending"),(0,n.My)("createdAt","desc")),o=await (0,n.getDocs)(t),r=[];return o.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){var t;return console.error("Error getting pending invitations:",e),(null==e?void 0:e.code)==="failed-precondition"&&(null==e||null==(t=e.message)?void 0:t.includes("index"))&&console.warn("Firestore index missing for getPendingInvitations - returning empty results to prevent infinite loops"),[]}},k=async e=>{try{let t=(0,n.query)((0,n.collection)(a.firestore,"invitations"),(0,n.where)("testResultId","==",e),(0,n.where)("status","==","completed")),o=(await (0,n.getDocs)(t)).docs.map(e=>e.id);if(0===o.length)return[];let r=(0,n.query)((0,n.collection)(a.firestore,"anonymousFeedback"),(0,n.where)("invitationId","in",o),(0,n.My)("submittedAt","desc")),s=await (0,n.getDocs)(r),i=[];return s.forEach(e=>{i.push(e.data())}),i}catch(e){throw console.error("Error getting feedback for result:",e),e}},b=async(e,t)=>{try{console.log("\uD83D\uDDD1️ Attempting to delete test result: ".concat(e," for user: ").concat(t));let o=(0,n.H9)(a.firestore,"testResults",e),r=await (0,n.x7)(o);if(!r.exists())return console.log("❌ Test result ".concat(e," does not exist")),{success:!1,message:"Test result not found"};if(r.data().userId!==t)return console.log("❌ User ".concat(t," is not authorized to delete test result ").concat(e)),{success:!1,message:"Not authorized to delete this test result"};return await (0,n.kd)(o),console.log("✅ Successfully deleted test result: ".concat(e)),{success:!0,message:"Test result deleted successfully"}}catch(t){return console.error("❌ Failed to delete test result ".concat(e,":"),t),{success:!1,message:"Failed to delete test result: ".concat(t instanceof Error?t.message:"Unknown error")}}},_=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{console.log("\uD83D\uDD0D Fetching ".concat(e," random General Knowledge questions in ").concat(t," from database..."));let o=(0,n.collection)(a.firestore,"generalKnowledgeQuestions"),r=(0,n.query)(o,(0,n.where)("isActive","==",!0),(0,n.where)("availableLanguages","array-contains",t)),s=await (0,n.getDocs)(r);if(s.empty)return console.warn("⚠️ No questions found in database for language ".concat(t,", falling back...")),E(e,t);let i=[];s.forEach(e=>{let o=e.data(),n=o.translations[t]||o.translations[o.defaultLanguage];if(!n)return void console.warn("⚠️ No translation found for question ".concat(e.id," in language ").concat(t));let a={id:e.id,text_key:n.question,type:"multiple_choice",options:[{value:"a",text_key:n.options.a},{value:"b",text_key:n.options.b},{value:"c",text_key:n.options.c},{value:"d",text_key:n.options.d}]};i.push(a)});let c=i.sort(()=>.5-Math.random()).slice(0,e);return console.log("✅ Successfully fetched ".concat(c.length," random questions in ").concat(t," from database")),c}catch(o){return console.error("❌ Error fetching questions from database in ".concat(t,":"),o),console.log("\uD83D\uDD04 Falling back to hardcoded questions..."),E(e,t)}},D=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{console.log("\uD83D\uDD0D Fetching ".concat(e," random General Knowledge questions with answers in ").concat(t," from database..."));let o=(0,n.collection)(a.firestore,"generalKnowledgeQuestions"),r=(0,n.query)(o,(0,n.where)("isActive","==",!0),(0,n.where)("availableLanguages","array-contains",t)),s=await (0,n.getDocs)(r);if(s.empty)return console.warn("⚠️ No questions found in database for language ".concat(t,", falling back...")),{questions:E(e,t),correctAnswers:[]};let i=[],c=[];s.forEach(e=>{let o=e.data(),n=o.translations[t]||o.translations[o.defaultLanguage];if(!n)return void console.warn("⚠️ No translation found for question ".concat(e.id," in language ").concat(t));let a={id:e.id,text_key:n.question,type:"multiple_choice",options:[{value:"a",text_key:n.options.a},{value:"b",text_key:n.options.b},{value:"c",text_key:n.options.c},{value:"d",text_key:n.options.d}]};i.push(a),c.push({id:e.id,correctAnswer:o.correctAnswer})});let l=[...Array(i.length).keys()].sort(()=>.5-Math.random()).slice(0,e),u=l.map(e=>i[e]),d=l.map(e=>c[e]);return console.log("✅ Successfully fetched ".concat(u.length," general knowledge questions with answers")),{questions:u,correctAnswers:d}}catch(o){return console.error("❌ Error fetching general knowledge questions with answers:",o),{questions:E(e,t),correctAnswers:[]}}},E=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],[{id:"gk_fallback_1",text_key:"tests.general_knowledge.questions.q1",type:"multiple_choice",options:[{value:"jordan",text_key:"tests.general_knowledge.options.q1_d"},{value:"egypt",text_key:"tests.general_knowledge.options.q1_a"},{value:"china",text_key:"tests.general_knowledge.options.q1_b"},{value:"peru",text_key:"tests.general_knowledge.options.q1_c"}]},{id:"gk_fallback_2",text_key:"tests.general_knowledge.questions.q2",type:"multiple_choice",options:[{value:"venus",text_key:"tests.general_knowledge.options.q2_b"},{value:"mercury",text_key:"tests.general_knowledge.options.q2_a"},{value:"mars",text_key:"tests.general_knowledge.options.q2_c"},{value:"jupiter",text_key:"tests.general_knowledge.options.q2_d"}]}].slice(0,e)},q=async()=>{try{let e=(0,n.collection)(a.firestore,"generalKnowledgeQuestions"),t=await (0,n.getDocs)(e),o=0,r=0,s={},i={};return t.forEach(e=>{let t=e.data();o++,t.isActive&&r++,s[t.category]=(s[t.category]||0)+1,i[t.difficulty]=(i[t.difficulty]||0)+1}),{total:o,active:r,byCategory:s,byDifficulty:i}}catch(e){return console.error("❌ Error getting stats:",e),{total:0,active:0,byCategory:{},byDifficulty:{}}}},S=async e=>{try{let t=0,o=0,r=(0,n.collection)(a.firestore,"generalKnowledgeQuestions");for(let a of e)try{await (0,n.gS)(r,{...a,createdAt:(0,n.O5)(),updatedAt:(0,n.O5)()}),t++,console.log("✅ Added multilingual question ".concat(t,"/").concat(e.length))}catch(e){o++,console.error("❌ Error adding question ".concat(t+o,":"),e)}return{success:t>0,added:t,errors:o,message:"Successfully added ".concat(t," multilingual questions. ").concat(o," errors.")}}catch(t){return console.error("❌ Batch upload error:",t),{success:!1,added:0,errors:e.length,message:"Batch upload failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},I=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",o=arguments.length>2?arguments[2]:void 0;try{console.log("\uD83D\uDD0D Fetching ".concat(e," random Math Speed questions in ").concat(t," from database..."));let r=(0,n.collection)(a.firestore,"mathSpeedQuestions"),s=(0,n.query)(r,(0,n.where)("isActive","==",!0),(0,n.where)("availableLanguages","array-contains",t));o&&(s=(0,n.query)(s,(0,n.where)("difficulty","==",o)));let i=await (0,n.getDocs)(s);if(i.empty)return console.warn("⚠️ No math speed questions found in database for language ".concat(t,", falling back...")),[];let c=[];i.forEach(e=>{let o=e.data(),n=o.translations[t]||o.translations[o.defaultLanguage];if(!n)return void console.warn("⚠️ No translation found for math question ".concat(e.id," in language ").concat(t));let a={id:e.id,text_key:n.question,type:"multiple_choice",options:[{value:"a",text_key:n.options.a},{value:"b",text_key:n.options.b},{value:"c",text_key:n.options.c},{value:"d",text_key:n.options.d}]};c.push(a)});let l=c.sort(()=>.5-Math.random()).slice(0,e);return console.log("✅ Successfully fetched ".concat(l.length," math speed questions")),l}catch(e){return console.error("❌ Error fetching math speed questions:",e),[]}},C=async e=>{try{let t=(0,n.collection)(a.firestore,"mathSpeedQuestions");return(await (0,n.gS)(t,{...e,createdAt:n.Dc.now(),updatedAt:n.Dc.now()})).id}catch(e){return console.error("❌ Error adding math speed question:",e),null}},A=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",o=arguments.length>2?arguments[2]:void 0;try{console.log("\uD83D\uDCCA Fetching ".concat(e," memory power questions for language: ").concat(t));let r=(0,n.collection)(a.firestore,"memoryPowerQuestions"),s=(0,n.query)(r,(0,n.where)("isActive","==",!0),(0,n.where)("availableLanguages","array-contains",t));o&&(s=(0,n.query)(s,(0,n.where)("difficulty","==",o)));let i=await (0,n.getDocs)(s);console.log("\uD83D\uDCCA Found ".concat(i.docs.length," memory power questions in database"));let c=[];i.forEach(e=>{let o=e.data(),n=o.translations[t]||o.translations[o.defaultLanguage];if(!n)return void console.warn("⚠️ No translation found for memory power question ".concat(e.id," in language ").concat(t));let a={id:e.id,text_key:n.question,type:"multiple_choice",options:[{value:"a",text_key:n.options.a},{value:"b",text_key:n.options.b},{value:"c",text_key:n.options.c},{value:"d",text_key:n.options.d}],memoryPhase:{content:n.memorizationContent,duration:1e3*o.memorizationTime}};c.push(a)});let l=c.sort(()=>.5-Math.random()).slice(0,e);return console.log("✅ Successfully fetched ".concat(l.length," memory power questions")),l}catch(e){return console.error("❌ Error fetching memory power questions:",e),[]}},P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",o=arguments.length>2?arguments[2]:void 0;try{console.log("\uD83D\uDCCA Fetching ".concat(e," memory power questions with answers for language: ").concat(t));let r=(0,n.collection)(a.firestore,"memoryPowerQuestions"),s=(0,n.query)(r,(0,n.where)("isActive","==",!0),(0,n.where)("availableLanguages","array-contains",t));o&&(s=(0,n.query)(s,(0,n.where)("difficulty","==",o)));let i=await (0,n.getDocs)(s);console.log("\uD83D\uDCCA Found ".concat(i.docs.length," memory power questions in database"));let c=[],l=[];i.forEach(e=>{let o=e.data(),n=o.translations[t]||o.translations[o.defaultLanguage];if(!n)return void console.warn("⚠️ No translation found for memory power question ".concat(e.id," in language ").concat(t));let a={id:e.id,text_key:n.question,type:"multiple_choice",options:[{value:"a",text_key:n.options.a},{value:"b",text_key:n.options.b},{value:"c",text_key:n.options.c},{value:"d",text_key:n.options.d}],memoryPhase:{content:n.memorizationContent,duration:1e3*o.memorizationTime}};c.push(a),l.push({id:e.id,correctAnswer:o.correctAnswer})});let u=c.sort(()=>.5-Math.random()).slice(0,e),d=u.map(e=>e.id),g=l.filter(e=>d.includes(e.id));return console.log("✅ Successfully fetched ".concat(u.length," memory power questions with answers")),{questions:u,correctAnswers:g}}catch(e){return console.error("❌ Error fetching memory power questions with answers:",e),{questions:[],correctAnswers:[]}}},U=async e=>{try{let t=(0,n.collection)(a.firestore,"memoryPowerQuestions");return(await (0,n.gS)(t,{...e,createdAt:n.Dc.now(),updatedAt:n.Dc.now()})).id}catch(e){return console.error("❌ Error adding memory power question:",e),null}},x=async e=>{try{let o=0,n=0;for(let a of e){var t;console.log("\uD83D\uDCCA Adding math question ".concat(o+1,": ").concat((null==(t=a.translations.en)?void 0:t.question)||a.category)),await C(a)?(o++,console.log("✅ Added math question ".concat(o))):(n++,console.log("❌ Error adding math question"))}return{success:o>0,added:o,errors:n,message:"Successfully added ".concat(o," math speed questions. ").concat(n," errors.")}}catch(t){return console.error("❌ Batch upload math questions error:",t),{success:!1,added:0,errors:e.length,message:"Batch upload failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},L=async()=>{try{let e=(0,n.collection)(a.firestore,"mathSpeedQuestions"),t=await (0,n.getDocs)(e),o=0,r=0,s={},i={};return t.forEach(e=>{let t=e.data();o++,t.isActive&&r++,s[t.category]=(s[t.category]||0)+1,i[t.difficulty]=(i[t.difficulty]||0)+1}),{total:o,active:r,byCategory:s,byDifficulty:i}}catch(e){return console.error("❌ Error getting math speed question stats:",e),{total:0,active:0,byCategory:{},byDifficulty:{}}}},M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;try{let s=(0,n.collection)(a.firestore,"mathSpeedQuestions"),i=(0,n.query)(s,(0,n.My)("createdAt","desc"),(0,n.AB)(e));o&&(i=(0,n.query)(s,(0,n.where)("category","==",o),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),r&&(i=(0,n.query)(s,(0,n.where)("difficulty","==",r),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),t&&(i=(0,n.query)(i,(0,n.HM)(t)));let c=await (0,n.getDocs)(i),l=[];c.forEach(e=>{l.push({...e.data(),id:e.id})});let u=c.docs[c.docs.length-1];return{questions:l,lastDoc:u}}catch(e){return console.error("❌ Error getting math speed questions:",e),{questions:[],lastDoc:null}}},R=async e=>{try{let t=(0,n.H9)(a.firestore,"mathSpeedQuestions",e);return await (0,n.kd)(t),console.log("✅ Deleted math speed question ".concat(e)),{success:!0,message:"Math Speed question deleted successfully"}}catch(t){return console.error("❌ Error deleting math speed question ".concat(e,":"),t),{success:!1,message:"Failed to delete question: ".concat(t instanceof Error?t.message:"Unknown error")}}},F=async e=>{try{let t=0,o=0;for(let n of e)(await R(n)).success?t++:o++;return{success:t>0,deleted:t,errors:o,message:"Deleted ".concat(t," math speed questions. ").concat(o," errors.")}}catch(t){return console.error("❌ Error in bulk delete math speed questions:",t),{success:!1,deleted:0,errors:e.length,message:"Bulk delete failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},T=async()=>{try{console.log("\uD83E\uDDF9 Starting to clear all math speed questions...");let e=(0,n.collection)(a.firestore,"mathSpeedQuestions"),t=await (0,n.getDocs)(e),o=(0,n.wP)(a.firestore),r=0;return t.docs.forEach(e=>{o.delete(e.ref),r++}),await o.commit(),console.log("✅ Successfully cleared ".concat(r," math speed questions")),{success:!0,deleted:r,message:"Successfully cleared all ".concat(r," math speed questions")}}catch(e){return console.error("❌ Error clearing all math speed questions:",e),{success:!1,deleted:0,message:"Failed to clear questions: ".concat(e instanceof Error?e.message:"Unknown error")}}},B=async e=>{try{let o=0,n=0;for(let a of e){var t;console.log("\uD83E\uDDE0 Adding memory question ".concat(o+1,": ").concat((null==(t=a.translations.en)?void 0:t.question)||a.category)),await U(a)?(o++,console.log("✅ Added memory question ".concat(o))):(n++,console.log("❌ Error adding memory question"))}return{success:o>0,added:o,errors:n,message:"Successfully added ".concat(o," memory power questions. ").concat(n," errors.")}}catch(t){return console.error("❌ Batch upload memory questions error:",t),{success:!1,added:0,errors:e.length,message:"Batch upload failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},N=async()=>{try{let e=(0,n.collection)(a.firestore,"memoryPowerQuestions"),t=await (0,n.getDocs)(e),o=0,r=0,s={},i={};return t.forEach(e=>{let t=e.data();o++,t.isActive&&r++,s[t.category]=(s[t.category]||0)+1,i[t.difficulty]=(i[t.difficulty]||0)+1}),{total:o,active:r,byCategory:s,byDifficulty:i}}catch(e){return console.error("❌ Error getting memory power question stats:",e),{total:0,active:0,byCategory:{},byDifficulty:{}}}},O=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;try{let s=(0,n.collection)(a.firestore,"memoryPowerQuestions"),i=(0,n.query)(s,(0,n.My)("createdAt","desc"),(0,n.AB)(e));o&&(i=(0,n.query)(s,(0,n.where)("category","==",o),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),r&&(i=(0,n.query)(s,(0,n.where)("difficulty","==",r),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),t&&(i=(0,n.query)(i,(0,n.HM)(t)));let c=await (0,n.getDocs)(i),l=[];c.forEach(e=>{l.push({...e.data(),id:e.id})});let u=c.docs[c.docs.length-1];return{questions:l,lastDoc:u}}catch(e){return console.error("❌ Error getting memory power questions:",e),{questions:[],lastDoc:null}}},Q=async e=>{try{let t=(0,n.H9)(a.firestore,"memoryPowerQuestions",e);return await (0,n.kd)(t),console.log("✅ Deleted memory power question ".concat(e)),{success:!0,message:"Memory Power question deleted successfully"}}catch(t){return console.error("❌ Error deleting memory power question ".concat(e,":"),t),{success:!1,message:"Failed to delete question: ".concat(t instanceof Error?t.message:"Unknown error")}}},K=async e=>{try{let t=0,o=0;for(let n of e)(await Q(n)).success?t++:o++;return{success:t>0,deleted:t,errors:o,message:"Deleted ".concat(t," memory power questions. ").concat(o," errors.")}}catch(t){return console.error("❌ Error in bulk delete memory power questions:",t),{success:!1,deleted:0,errors:e.length,message:"Bulk delete failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},H=async()=>{try{console.log("\uD83E\uDDF9 Starting to clear all memory power questions...");let e=(0,n.collection)(a.firestore,"memoryPowerQuestions"),t=await (0,n.getDocs)(e),o=(0,n.wP)(a.firestore),r=0;return t.docs.forEach(e=>{o.delete(e.ref),r++}),await o.commit(),console.log("✅ Successfully cleared ".concat(r," memory power questions")),{success:!0,deleted:r,message:"Successfully cleared all ".concat(r," memory power questions")}}catch(e){return console.error("❌ Error clearing all memory power questions:",e),{success:!1,deleted:0,message:"Failed to clear questions: ".concat(e instanceof Error?e.message:"Unknown error")}}},Y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;try{let s=(0,n.collection)(a.firestore,"generalKnowledgeQuestions"),i=(0,n.query)(s,(0,n.My)("createdAt","desc"),(0,n.AB)(e));o&&(i=(0,n.query)(s,(0,n.where)("category","==",o),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),r&&(i=(0,n.query)(s,(0,n.where)("difficulty","==",r),(0,n.My)("createdAt","desc"),(0,n.AB)(e))),t&&(i=(0,n.query)(i,(0,n.HM)(t)));let c=await (0,n.getDocs)(i),l=[];c.forEach(e=>{l.push({...e.data(),id:e.id})});let u=c.docs[c.docs.length-1];return{questions:l,lastDoc:u}}catch(e){return console.error("❌ Error getting general knowledge questions:",e),{questions:[],lastDoc:null}}},G=async e=>{try{let t=(0,n.H9)(a.firestore,"generalKnowledgeQuestions",e);return await (0,n.kd)(t),console.log("✅ Deleted question ".concat(e)),{success:!0,message:"Question deleted successfully"}}catch(t){return console.error("❌ Error deleting question ".concat(e,":"),t),{success:!1,message:"Failed to delete question: ".concat(t instanceof Error?t.message:"Unknown error")}}},J=async e=>{try{let t=0,o=0;for(let n of e)(await G(n)).success?t++:o++;return{success:t>0,deleted:t,errors:o,message:"Deleted ".concat(t," questions. ").concat(o," errors.")}}catch(t){return console.error("❌ Error in bulk delete:",t),{success:!1,deleted:0,errors:e.length,message:"Bulk delete failed: ".concat(t instanceof Error?t.message:"Unknown error")}}},j=async()=>{try{console.log("\uD83E\uDDF9 Starting to clear all general knowledge questions...");let e=(0,n.collection)(a.firestore,"generalKnowledgeQuestions"),t=await (0,n.getDocs)(e),o=(0,n.wP)(a.firestore),r=0;return t.docs.forEach(e=>{o.delete(e.ref),r++}),await o.commit(),console.log("✅ Successfully cleared ".concat(r," general knowledge questions")),{success:!0,deleted:r,message:"Successfully cleared all ".concat(r," general knowledge questions")}}catch(e){return console.error("❌ Error clearing all general knowledge questions:",e),{success:!1,deleted:0,message:"Failed to clear questions: ".concat(e instanceof Error?e.message:"Unknown error")}}},z=async e=>{try{let t={...e,status:"new",createdAt:(0,n.O5)()},o=await (0,n.gS)((0,n.collection)(a.firestore,"contactMessages"),t);return console.log("✅ Contact message created with ID:",o.id),o.id}catch(e){throw console.error("❌ Error creating contact message:",e),e}},V=async()=>{try{let e=(0,n.query)((0,n.collection)(a.firestore,"contactMessages"),(0,n.My)("createdAt","desc")),t=await (0,n.getDocs)(e),o=[];return t.forEach(e=>{o.push({id:e.id,...e.data()})}),o}catch(e){throw console.error("❌ Error fetching contact messages:",e),e}},W=async(e,t,o)=>{try{let r=(0,n.H9)(a.firestore,"contactMessages",e),s={status:t,...void 0!==o&&{adminNotes:o},..."read"===t&&{readAt:(0,n.O5)()},..."resolved"===t&&{resolvedAt:(0,n.O5)()}};await (0,n.BN)(r,s,{merge:!0}),console.log("✅ Contact message ".concat(e," status updated to: ").concat(t))}catch(e){throw console.error("❌ Error updating contact message status:",e),e}},X=async e=>{try{let t=(0,n.H9)(a.firestore,"contactMessages",e);await (0,n.kd)(t),console.log("✅ Contact message ".concat(e," deleted"))}catch(e){throw console.error("❌ Error deleting contact message:",e),e}},Z=async e=>{try{let t=(0,n.query)((0,n.collection)(a.firestore,"contactMessages"),(0,n.where)("status","==",e)),o=await (0,n.getDocs)(t),r=[];return o.forEach(e=>{r.push({id:e.id,...e.data()})}),r.sort((e,t)=>{var o,n;let a=(null==(o=e.createdAt)?void 0:o.toMillis())||0;return((null==(n=t.createdAt)?void 0:n.toMillis())||0)-a})}catch(e){throw console.error("❌ Error fetching contact messages by status:",e),e}},$=async e=>{try{let t=(0,n.H9)(a.firestore,"users",e),o=await (0,n.x7)(t);if(o.exists()){let e=o.data();return"admin"===e.role}return!1}catch(e){return console.error("❌ Error checking admin role:",e),!1}},ee=async()=>{try{let e=await (0,n.getDocs)((0,n.collection)(a.firestore,"languageConfigs")),t=[];return e.forEach(e=>{t.push({id:e.id,...e.data()})}),t.sort((e,t)=>e.isDefault&&!t.isDefault?-1:!e.isDefault&&t.isDefault?1:e.name.localeCompare(t.name))}catch(e){return console.error("❌ Error fetching language configs:",e),[{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8",isEnabled:!0,isDefault:!0,completionPercentage:100,lastUpdated:n.Dc.now()}]}},et=async()=>{try{return(await ee()).filter(e=>e.isEnabled)}catch(e){return console.error("❌ Error fetching enabled languages:",e),[{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8",isEnabled:!0,isDefault:!0,completionPercentage:100,lastUpdated:n.Dc.now()}]}},eo=async(e,t)=>{try{let o=(0,n.H9)(a.firestore,"languageConfigs",e);await (0,n.BN)(o,{...t,lastUpdated:(0,n.O5)()},{merge:!0}),console.log("✅ Language config ".concat(e," updated"))}catch(e){throw console.error("❌ Error updating language config:",e),e}},en=async()=>{try{if(!(await (0,n.getDocs)((0,n.collection)(a.firestore,"languageConfigs"))).empty)return void console.log("Language configs already exist, skipping initialization");for(let e of[{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8",isEnabled:!0,isDefault:!0,completionPercentage:100},{code:"ko",name:"한국어",flag:"\uD83C\uDDF0\uD83C\uDDF7",isEnabled:!1,isDefault:!1,completionPercentage:85},{code:"ja",name:"日本語",flag:"\uD83C\uDDEF\uD83C\uDDF5",isEnabled:!1,isDefault:!1,completionPercentage:70},{code:"zh",name:"中文",flag:"\uD83C\uDDE8\uD83C\uDDF3",isEnabled:!1,isDefault:!1,completionPercentage:60},{code:"es",name:"Espa\xf1ol",flag:"\uD83C\uDDEA\uD83C\uDDF8",isEnabled:!1,isDefault:!1,completionPercentage:50},{code:"fr",name:"Fran\xe7ais",flag:"\uD83C\uDDEB\uD83C\uDDF7",isEnabled:!1,isDefault:!1,completionPercentage:40},{code:"de",name:"Deutsch",flag:"\uD83C\uDDE9\uD83C\uDDEA",isEnabled:!1,isDefault:!1,completionPercentage:35},{code:"it",name:"Italiano",flag:"\uD83C\uDDEE\uD83C\uDDF9",isEnabled:!1,isDefault:!1,completionPercentage:30},{code:"pt",name:"Portugu\xeas",flag:"\uD83C\uDDF5\uD83C\uDDF9",isEnabled:!1,isDefault:!1,completionPercentage:25}])await (0,n.gS)((0,n.collection)(a.firestore,"languageConfigs"),{...e,lastUpdated:(0,n.O5)()});console.log("✅ Language configurations initialized successfully")}catch(e){throw console.error("❌ Error initializing language configs:",e),e}}}}]);