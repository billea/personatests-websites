(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{707:(e,t,s)=>{Promise.resolve().then(s.bind(s,6429))},5695:(e,t,s)=>{"use strict";var i=s(8999);s.o(i,"useParams")&&s.d(t,{useParams:function(){return i.useParams}}),s.o(i,"usePathname")&&s.d(t,{usePathname:function(){return i.usePathname}}),s.o(i,"useRouter")&&s.d(t,{useRouter:function(){return i.useRouter}}),s.o(i,"useSearchParams")&&s.d(t,{useSearchParams:function(){return i.useSearchParams}})},6429:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var i=s(5155),a=s(7550),o=s(7200),r=s(5695),n=s(2115),l=s(3722),c=s(9086);function d(e){let{testType:t,personalityType:s}=e,{t:l}=(0,a.B)(),{user:c}=(0,o.A)(),d=(0,r.useRouter)(),[m,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),v=["math-speed","general-knowledge","memory-power"].includes(t),w=async e=>{if(e.preventDefault(),m){g(!0);try{await new Promise(e=>setTimeout(e,1e3));let e=JSON.parse(localStorage.getItem("email_signups")||"[]");e.push({email:m,testType:t,personalityType:s,signedUpAt:new Date().toISOString()}),localStorage.setItem("email_signups",JSON.stringify(e)),p(!0)}catch(e){console.error("Error signing up:",e),alert("Error signing up. Please try again.")}finally{g(!1)}}};return v?(0,i.jsx)("div",{className:"mt-8 p-6 bg-gradient-to-r from-blue-500/20 to-purple-500/20 backdrop-blur-sm border border-white/30 rounded-lg",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-3",children:"Want to See More Details About Your Results?"}),(0,i.jsx)("p",{className:"text-white/90 mb-4",children:c?"Access your detailed performance analysis, question breakdowns, and improvement recommendations in your dashboard.":"Sign in or create an account to access detailed performance analysis, question breakdowns, and improvement recommendations."}),c?(0,i.jsx)("button",{onClick:()=>d.push("/en/results"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-blue-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105",children:"\uD83D\uDCCA View Detailed Analysis"}):(0,i.jsx)("button",{onClick:()=>{let e=window.location.pathname,s={testType:t,preserveResult:!0,timestamp:Date.now()};localStorage.setItem("preserve_test_result",JSON.stringify(s)),d.push("/en/auth?returnUrl=".concat(encodeURIComponent("".concat(e,"?access=detailed&preserve=true")),"&context=detailed-results"))},className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105",children:"\uD83D\uDD10 Sign In / Sign Up"}),(0,i.jsx)("p",{className:"text-white/70 text-sm mt-2",children:c?"✓ Detailed analysis ✓ Performance tracking ✓ Progress history":"✓ Free account ✓ Detailed analysis ✓ Performance tracking"})]})}):b?h?(0,i.jsxs)("div",{className:"mt-8 p-6 bg-gradient-to-r from-green-500/20 to-blue-500/20 backdrop-blur-sm border border-white/30 rounded-lg text-center",children:[(0,i.jsx)("div",{className:"text-4xl mb-3",children:"✅"}),(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"Thank You!"}),(0,i.jsx)("p",{className:"text-white/90",children:v?"Check your email for your detailed performance report and analysis!":"Check your email for personalized ".concat(s," insights and tips!")})]}):(0,i.jsxs)("div",{className:"mt-8 p-6 bg-gradient-to-r from-blue-500/20 to-purple-500/20 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("div",{className:"text-center mb-6",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:v?"Get Your Detailed Performance Report":"Get Your Complete ".concat(s||"Personality"," Guide")}),(0,i.jsx)("p",{className:"text-white/90",children:v?"Access in-depth analysis of your performance, question-by-question breakdown, and personalized improvement insights.":"Receive detailed insights, career advice, and relationship tips tailored for your personality type."})]}),(0,i.jsxs)("form",{onSubmit:w,className:"max-w-md mx-auto",children:[(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("input",{type:"email",value:m,onChange:e=>u(e.target.value),placeholder:"Enter your email address",required:!0,className:"flex-1 px-4 py-3 rounded-lg bg-white/10 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent"}),(0,i.jsx)("button",{type:"submit",disabled:x,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"...":v?"Get Report":"Get Insights"})]}),(0,i.jsxs)("div",{className:"mt-4 text-center",children:[(0,i.jsx)("p",{className:"text-white/70 text-sm",children:v?"✓ Performance analysis ✓ Question breakdown ✓ Improvement tips":"✓ Free personality guide ✓ Career recommendations ✓ Relationship tips"}),(0,i.jsx)("p",{className:"text-white/60 text-xs mt-2",children:"We respect your privacy. Unsubscribe at any time."}),(0,i.jsx)("button",{type:"button",onClick:()=>f(!1),className:"text-white/60 hover:text-white/80 text-sm underline mt-2",children:"No thanks, skip this"})]})]})]}):(0,i.jsx)("div",{className:"mt-8 p-6 bg-gradient-to-r from-blue-500/20 to-purple-500/20 backdrop-blur-sm border border-white/30 rounded-lg",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-3",children:l("emailSignup.title")||"Want More Insights About Your ".concat(s||"Personality","?")}),(0,i.jsx)("p",{className:"text-white/90 mb-4",children:l("emailSignup.description")||"Get personalized tips, detailed analysis, and exclusive personality insights delivered to your inbox."}),(0,i.jsxs)("button",{onClick:()=>f(!0),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105",children:["✨ ",l("emailSignup.buttonText")||"Get Free Personality Insights"]}),(0,i.jsxs)("p",{className:"text-white/70 text-sm mt-2",children:[l("emailSignup.freeText")||"100% free"," • ",l("emailSignup.unsubscribeText")||"Unsubscribe anytime"," • ",l("emailSignup.noSpamText")||"No spam"]})]})})}function m(e){var t;let{onMethodSelect:s,testId:o}=e,{t:r}=(0,a.B)(),[l,c]=(0,n.useState)(null),d=[{id:"email",icon:"\uD83D\uDCE7",title:r("invitation.email.title")||"Email Invitations",description:r("invitation.email.description")||"Send direct email invites to specific people",privacy:r("invitation.privacy.standard")||"Standard Privacy",effort:r("invitation.effort.easy")||"Easy Setup",pros:[r("invitation.email.pro1")||"Higher response rate",r("invitation.email.pro2")||"Direct delivery to inbox",r("invitation.email.pro3")||"Familiar process"],cons:[r("invitation.email.con1")||"Email addresses are recorded",r("invitation.email.con2")||"Requires recipients to have email accounts"]},{id:"codes",icon:"\uD83D\uDD11",title:r("invitation.codes.title")||"Anonymous Codes",description:r("invitation.codes.description")||"Generate codes to share manually via text, chat, or in-person",privacy:r("invitation.privacy.maximum")||"Maximum Privacy",effort:r("invitation.effort.manual")||"Manual Sharing",pros:[r("invitation.codes.pro1")||"Complete anonymity",r("invitation.codes.pro2")||"No email tracking",r("invitation.codes.pro3")||"Flexible sharing methods"],cons:[r("invitation.codes.con1")||"Lower response rate",r("invitation.codes.con2")||"Codes might get lost"]},{id:"link",icon:"\uD83D\uDD17",title:r("invitation.link.title")||"Shareable Link",description:r("invitation.link.description")||"Create one link to share on social media or with groups",privacy:r("invitation.privacy.high")||"High Privacy",effort:r("invitation.effort.veryeasy")||"Very Easy",pros:[r("invitation.link.pro1")||"Easy to share widely",r("invitation.link.pro2")||"Great for social media",r("invitation.link.pro3")||"No individual tracking"],cons:[r("invitation.link.con1")||"Can't control who responds",r("invitation.link.con2")||"Potential for random responses"]},{id:"mixed",icon:"\uD83C\uDFAF",title:r("invitation.mixed.title")||"Multiple Methods",description:r("invitation.mixed.description")||"Use different invitation methods for different situations",privacy:r("invitation.privacy.flexible")||"Flexible Privacy",effort:r("invitation.effort.custom")||"Custom Setup",pros:[r("invitation.mixed.pro1")||"Best of all methods",r("invitation.mixed.pro2")||"Adapt to different relationships",r("invitation.mixed.pro3")||"Maximum flexibility"],cons:[r("invitation.mixed.con1")||"More complex setup",r("invitation.mixed.con2")||"Need to manage multiple methods"]}];return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:r("invitation.selector.title")||"How would you like to collect feedback?"}),(0,i.jsx)("p",{className:"text-white/80",children:r("invitation.selector.subtitle")||"Choose the method that works best for your situation and privacy preferences."})]}),(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:d.map(e=>(0,i.jsx)("div",{onClick:()=>{var t;c(t=e.id),s(t)},className:"p-6 rounded-lg border cursor-pointer transition-all duration-300 ".concat(l===e.id?"border-blue-400 bg-blue-500/20 backdrop-blur-sm":"border-white/30 bg-white/10 backdrop-blur-sm hover:bg-white/20 hover:border-white/50"),children:(0,i.jsxs)("div",{className:"flex items-start gap-4",children:[(0,i.jsx)("div",{className:"text-3xl",children:e.icon}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:e.title}),(0,i.jsx)("p",{className:"text-white/80 text-sm mb-3",children:e.description}),(0,i.jsxs)("div",{className:"flex gap-4 text-xs mb-3",children:[(0,i.jsx)("span",{className:"px-2 py-1 bg-white/20 rounded-full text-white",children:e.privacy}),(0,i.jsx)("span",{className:"px-2 py-1 bg-white/20 rounded-full text-white",children:e.effort})]}),(0,i.jsxs)("div",{className:"text-xs text-white/70",children:[(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("strong",{className:"text-green-400",children:"✓ Pros:"}),(0,i.jsx)("ul",{className:"ml-4 mt-1",children:e.pros.map((e,t)=>(0,i.jsxs)("li",{children:["• ",e]},t))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{className:"text-yellow-400",children:"⚠ Cons:"}),(0,i.jsx)("ul",{className:"ml-4 mt-1",children:e.cons.map((e,t)=>(0,i.jsxs)("li",{children:["• ",e]},t))})]})]})]})]})},e.id))}),l&&(0,i.jsx)("div",{className:"mt-6 p-4 bg-blue-500/20 border border-blue-400 rounded-lg",children:(0,i.jsxs)("p",{className:"text-white text-center",children:[r("invitation.selector.selected")||"Selected:"," ",(0,i.jsx)("strong",{children:null==(t=d.find(e=>e.id===l))?void 0:t.title})]})})]})}function u(e){var t;let{testResultId:s,testId:o,userName:r,onCodesGenerated:l}=e,{t:c}=(0,a.B)(),[d,m]=(0,n.useState)(5),[u,h]=(0,n.useState)([]),[p,x]=(0,n.useState)(!1),[g,b]=(0,n.useState)(14),f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";return Array.from({length:e},()=>t.charAt(Math.floor(Math.random()*t.length))).join("")},v=async()=>{x(!0);try{let e=new Date,t=new Date(e.getTime()+24*g*36e5),i=Array.from({length:d},(i,a)=>({id:"code_".concat(s,"_").concat(a,"_").concat(Date.now()),code:f(8),testResultId:s,testId:o,userId:"current_user",userName:r,method:"codes",createdAt:e.toISOString(),expiresAt:t.toISOString(),status:"active",usageCount:0,lastUsedAt:void 0})),a=[...JSON.parse(localStorage.getItem("anonymous_codes")||"[]"),...i];localStorage.setItem("anonymous_codes",JSON.stringify(a)),h(i),l(i)}catch(e){console.error("Error generating codes:",e)}finally{x(!1)}},w=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){console.error("Failed to copy code:",e)}},y=async()=>{let e=u.map(e=>e.code).join("\\n");try{await navigator.clipboard.writeText(e)}catch(e){console.error("Failed to copy codes:",e)}},k=()=>{let e=window.location.origin;return"".concat(e,"/en/feedback/code")};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:c("invitation.codes.generate.title")||"Generate Anonymous Feedback Codes"}),(0,i.jsx)("p",{className:"text-white/80 text-sm",children:c("invitation.codes.generate.subtitle")||"Create codes you can share via text, chat, or in-person for maximum privacy"})]}),u.length?(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h4",{className:"text-lg font-bold text-white",children:c("invitation.codes.generated.title")||"Your Anonymous Feedback Codes"}),(0,i.jsxs)("button",{onClick:y,className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white text-sm rounded-lg transition-colors duration-300",children:["\uD83D\uDCCB ",c("invitation.codes.copyall")||"Copy All"]})]}),(0,i.jsx)("div",{className:"grid gap-2",children:u.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsxs)("span",{className:"text-white/60 text-sm",children:["#",t+1]}),(0,i.jsx)("code",{className:"text-lg font-mono text-white bg-white/20 px-3 py-1 rounded",children:e.code})]}),(0,i.jsx)("button",{onClick:()=>w(e.code),className:"px-3 py-1 bg-white/20 hover:bg-white/30 text-white text-sm rounded transition-colors duration-300",children:"\uD83D\uDCCB"})]},e.id))}),(0,i.jsxs)("div",{className:"p-4 bg-blue-500/20 border border-blue-400 rounded-lg",children:[(0,i.jsxs)("h5",{className:"font-bold text-white mb-2",children:["\uD83D\uDCF1 ",c("invitation.codes.sharing.title")||"How to Share These Codes"]}),(0,i.jsxs)("div",{className:"text-white/80 text-sm space-y-2",children:[(0,i.jsxs)("p",{children:[(0,i.jsxs)("strong",{children:[c("invitation.codes.sharing.url")||"Feedback URL:",":"]}),(0,i.jsx)("br",{}),(0,i.jsx)("code",{className:"text-xs bg-white/20 px-2 py-1 rounded",children:k()})]}),(0,i.jsxs)("p",{children:[(0,i.jsxs)("strong",{children:[c("invitation.codes.sharing.message")||"Sample message:",":"]}),(0,i.jsx)("br",{}),(0,i.jsxs)("em",{className:"text-xs",children:['"',c("invitation.codes.sharing.sample")||"Hi! I'm collecting anonymous feedback for personal growth. Please go to ".concat(k()," and use code: [CODE]. Takes 5-10 minutes. Thanks!"),'"']})]}),(0,i.jsxs)("div",{className:"text-xs text-white/60 mt-3",children:[(0,i.jsxs)("p",{children:["• ",c("invitation.codes.sharing.tip1")||"Share via text, WhatsApp, Discord, or in-person"]}),(0,i.jsxs)("p",{children:["• ",c("invitation.codes.sharing.tip2")||"Each code can be used multiple times"]}),(0,i.jsxs)("p",{children:["• ",c("invitation.codes.sharing.tip3")||"Codes expire on ".concat(new Date(null==(t=u[0])?void 0:t.expiresAt).toLocaleDateString())]})]})]})]})]}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:c("invitation.codes.count.label")||"Number of codes to generate"}),(0,i.jsx)("input",{type:"number",min:"1",max:"10",value:d,onChange:e=>m(Math.max(1,Math.min(10,parseInt(e.target.value)||1))),className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50"})]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:c("invitation.codes.expiry.label")||"Expires in (days)"}),(0,i.jsxs)("select",{value:g,onChange:e=>b(parseInt(e.target.value)),className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/50",children:[(0,i.jsx)("option",{value:7,className:"bg-gray-800",children:"7 days"}),(0,i.jsx)("option",{value:14,className:"bg-gray-800",children:"14 days"}),(0,i.jsx)("option",{value:30,className:"bg-gray-800",children:"30 days"})]})]})]}),(0,i.jsx)("button",{onClick:v,disabled:p,className:"w-full p-4 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-500/50 text-white font-bold rounded-lg transition-colors duration-300 flex items-center justify-center gap-2",children:p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),c("invitation.codes.generating")||"Generating codes..."]}):(0,i.jsxs)(i.Fragment,{children:["\uD83D\uDD11 ",c("invitation.codes.generate.button")||"Generate Anonymous Codes"]})})]})]})}function h(e){let{testResultId:t,testId:s,userName:o,onLinkGenerated:r}=e,{t:l}=(0,a.B)(),[c,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(14),[x,g]=(0,n.useState)(void 0),[b,f]=(0,n.useState)(!1),v=async()=>{u(!0);try{let e=new Date,i=new Date(e.getTime()+24*h*36e5),a="link_".concat(t,"_").concat(Date.now()),n={testResultId:t,testId:s,userId:"current_user",userName:o,createdAt:e.toISOString(),expiresAt:i.toISOString(),maxResponses:b?x:void 0},l=btoa(JSON.stringify(n)),c=window.location.origin,m="".concat(c,"/en/feedback/share?data=").concat(l),u={id:a,testResultId:t,testId:s,userId:"current_user",userName:o,method:"link",createdAt:e.toISOString(),expiresAt:i.toISOString(),status:"active",link:m,linkId:a,responseCount:0,maxResponses:b?x:void 0,isPublic:!0},p=[...JSON.parse(localStorage.getItem("shareable_links")||"[]"),u];localStorage.setItem("shareable_links",JSON.stringify(p)),d(u),r(u)}catch(e){console.error("Error generating shareable link:",e)}finally{u(!1)}},w=async()=>{if(c)try{await navigator.clipboard.writeText(c.link)}catch(e){console.error("Failed to copy link:",e)}};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:l("invitation.link.generate.title")||"Create Shareable Feedback Link"}),(0,i.jsx)("p",{className:"text-white/80 text-sm",children:l("invitation.link.generate.subtitle")||"Generate one link to share on social media, group chats, or anywhere online"})]}),c?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"p-4 bg-green-500/20 border border-green-400 rounded-lg",children:[(0,i.jsxs)("h4",{className:"text-lg font-bold text-white mb-3",children:["✅ ",l("invitation.link.generated.title")||"Your Shareable Feedback Link is Ready!"]}),(0,i.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,i.jsx)("input",{type:"text",value:c.link,readOnly:!0,className:"flex-1 p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white text-sm"}),(0,i.jsx)("button",{onClick:w,className:"px-4 py-3 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors duration-300",title:"Copy link",children:"\uD83D\uDCCB"})]}),(0,i.jsxs)("div",{className:"text-white/80 text-sm",children:[(0,i.jsxs)("p",{children:["• Expires: ",new Date(c.expiresAt).toLocaleDateString()]}),c.maxResponses&&(0,i.jsxs)("p",{children:["• Max responses: ",c.maxResponses]}),(0,i.jsxs)("p",{children:["• Current responses: ",c.responseCount]})]})]}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{className:"p-4 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg",children:[(0,i.jsxs)("h5",{className:"font-bold text-white mb-3",children:["\uD83D\uDCF1 ",l("invitation.link.social.title")||"Share on Social Media"]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries((()=>{if(!c)return{};let e=encodeURIComponent("Help me grow with anonymous feedback! Share your honest thoughts - takes 5-10 minutes. ".concat(c.link));return{twitter:"https://twitter.com/intent/tweet?text=".concat(e),facebook:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(c.link)),linkedin:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(c.link)),whatsapp:"https://wa.me/?text=".concat(e),telegram:"https://t.me/share/url?url=".concat(encodeURIComponent(c.link),"&text=").concat(encodeURIComponent("Help me grow with anonymous feedback!"))}})()).map(e=>{let[t,s]=e;return(0,i.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-2 bg-white/20 hover:bg-white/30 text-white text-sm rounded transition-colors duration-300 text-center capitalize",children:"whatsapp"===t?"WhatsApp":t},t)})})]}),(0,i.jsxs)("div",{className:"p-4 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg text-center",children:[(0,i.jsxs)("h5",{className:"font-bold text-white mb-3",children:["\uD83D\uDCF1 ",l("invitation.link.qr.title")||"QR Code"]}),(0,i.jsx)("img",{src:c?"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(c.link)):"",alt:"Feedback QR Code",className:"mx-auto mb-2 bg-white p-2 rounded",width:120,height:120}),(0,i.jsx)("p",{className:"text-white/70 text-xs",children:l("invitation.link.qr.description")||"Scan to access feedback form"})]})]}),(0,i.jsxs)("div",{className:"p-4 bg-blue-500/20 border border-blue-400 rounded-lg",children:[(0,i.jsxs)("h5",{className:"font-bold text-white mb-2",children:["\uD83D\uDCA1 ",l("invitation.link.tips.title")||"Sharing Tips"]}),(0,i.jsxs)("div",{className:"text-white/80 text-sm space-y-1",children:[(0,i.jsxs)("p",{children:["• ",l("invitation.link.tips.tip1")||"Perfect for social media posts and group chats"]}),(0,i.jsxs)("p",{children:["• ",l("invitation.link.tips.tip2")||"Anyone with the link can provide feedback"]}),(0,i.jsxs)("p",{children:["• ",l("invitation.link.tips.tip3")||"Responses are completely anonymous"]}),(0,i.jsxs)("p",{children:["• ",l("invitation.link.tips.tip4")||"Consider posting in multiple places for diverse feedback"]})]})]})]}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:l("invitation.link.expiry.label")||"Link expires in"}),(0,i.jsxs)("select",{value:h,onChange:e=>p(parseInt(e.target.value)),className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/50",children:[(0,i.jsx)("option",{value:7,className:"bg-gray-800",children:"7 days"}),(0,i.jsx)("option",{value:14,className:"bg-gray-800",children:"14 days"}),(0,i.jsx)("option",{value:30,className:"bg-gray-800",children:"30 days"}),(0,i.jsx)("option",{value:90,className:"bg-gray-800",children:"90 days"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:l("invitation.link.limit.label")||"Response limit (optional)"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{type:"checkbox",id:"enableLimit",checked:b,onChange:e=>f(e.target.checked),className:"mt-3"}),(0,i.jsx)("input",{type:"number",min:"1",max:"100",value:x||20,onChange:e=>g(parseInt(e.target.value)||void 0),disabled:!b,className:"flex-1 p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50 disabled:opacity-50",placeholder:"Max responses"})]})]})]}),(0,i.jsx)("button",{onClick:v,disabled:m,className:"w-full p-4 bg-green-500 hover:bg-green-600 disabled:bg-green-500/50 text-white font-bold rounded-lg transition-colors duration-300 flex items-center justify-center gap-2",children:m?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("invitation.link.generating")||"Generating link..."]}):(0,i.jsxs)(i.Fragment,{children:["\uD83D\uDD17 ",l("invitation.link.generate.button")||"Generate Shareable Link"]})})]})]})}function p(e){let{testId:t,testName:s,result:o,className:r="",variant:l="dropdown",showLabel:c=!0}=e,{t:d,currentLanguage:m}=(0,a.B)(),[u,h]=(0,n.useState)(!1),p=e=>{let i,a=(i="\uD83E\uDDE0 I just completed the ".concat(s,"!"),(null==o?void 0:o.type)&&(i+=" My result: ".concat(o.type)),(null==o?void 0:o.compatibility)&&(i+=" (".concat(o.compatibility,"% compatibility)")),(null==o?void 0:o.traits)&&o.traits.length>0&&(i+=" Traits: ".concat(o.traits.slice(0,2).join(", ")).concat(o.traits.length>2?"...":"")),i+=" ✨"),r="https://korean-mbti-platform.netlify.app/".concat(m,"/tests/").concat(t);switch(e){case"copy":let n="".concat(a,"\n\nTake the test yourself: ").concat(r);navigator.clipboard.writeText(n).then(()=>{alert(d("share.copied")||"Result link copied to clipboard!")}).catch(()=>{let e=document.createElement("textarea");e.value=n,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert(d("share.copied")||"Result link copied to clipboard!")});break;case"twitter":let l=encodeURIComponent("".concat(a,"\n\nTake the test: ").concat(r));window.open("https://twitter.com/intent/tweet?text=".concat(l),"_blank");break;case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(r),"&quote=").concat(encodeURIComponent(a)),"_blank");break;case"linkedin":let c=encodeURIComponent(a);window.open("https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(r),"&summary=").concat(c),"_blank");break;case"whatsapp":let u=encodeURIComponent("".concat(a,"\n\nTake the test: ").concat(r));window.open("https://wa.me/?text=".concat(u),"_blank");break;case"kakao":let p=encodeURIComponent("".concat(a,"\n\n테스트 해보기: ").concat(r));window.open("https://story.kakao.com/share?url=".concat(encodeURIComponent(r),"&text=").concat(p),"_blank");break;case"line":let x=encodeURIComponent("".concat(a,"\n\nTake the test: ").concat(r));window.open("https://social-plugins.line.me/lineit/share?url=".concat(encodeURIComponent(r),"&text=").concat(x),"_blank");break;case"telegram":let g=encodeURIComponent("".concat(a,"\n\nTake the test: ").concat(r));window.open("https://t.me/share/url?url=".concat(encodeURIComponent(r),"&text=").concat(g),"_blank");break;case"reddit":window.open("https://reddit.com/submit?url=".concat(encodeURIComponent(r),"&title=").concat(encodeURIComponent(a)),"_blank");break;case"email":let b=encodeURIComponent("Check out my ".concat(s," results!")),f=encodeURIComponent("".concat(a,"\n\nTake the test yourself: ").concat(r));window.open("mailto:?subject=".concat(b,"&body=").concat(f),"_blank")}h(!1)},x=[{id:"copy",label:d("share.copy_link")||"Copy Link",icon:"\uD83D\uDCCB",color:"gray"},{id:"whatsapp",label:d("share.whatsapp")||"WhatsApp",icon:"\uD83D\uDCAC",color:"green"},{id:"kakao",label:d("share.kakao")||"KakaoTalk",icon:"\uD83D\uDC9B",color:"yellow"},{id:"line",label:d("share.line")||"LINE",icon:"\uD83D\uDC9A",color:"green"},{id:"twitter",label:d("share.twitter")||"Twitter",icon:"\uD83D\uDC26",color:"blue"},{id:"facebook",label:d("share.facebook")||"Facebook",icon:"\uD83D\uDCD8",color:"blue"},{id:"linkedin",label:d("share.linkedin")||"LinkedIn",icon:"\uD83D\uDCBC",color:"blue"},{id:"telegram",label:d("share.telegram")||"Telegram",icon:"✈️",color:"blue"},{id:"reddit",label:d("share.reddit")||"Reddit",icon:"\uD83D\uDD34",color:"orange"},{id:"email",label:d("share.email")||"Email",icon:"\uD83D\uDCE7",color:"gray"}];return"button"===l?(0,i.jsxs)("button",{onClick:()=>p("copy"),className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 ".concat(r),children:[(0,i.jsx)("span",{className:"text-lg",children:"\uD83D\uDCE4"}),c&&(d("share.share_result")||"Share Result")]}):"grid"===l?(0,i.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20 ".concat(r),children:[(0,i.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE4"}),d("share.share_result")||"Share Your Result"]}),(0,i.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:x.map(e=>(0,i.jsxs)("button",{onClick:()=>p(e.id),className:"flex flex-col items-center gap-2 p-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-200 group",children:[(0,i.jsx)("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:e.icon}),(0,i.jsx)("span",{className:"text-xs text-white/80 text-center",children:e.label})]},e.id))})]}):(0,i.jsxs)("div",{className:"relative group ".concat(r),children:[(0,i.jsxs)("button",{onClick:()=>h(!u),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 text-sm font-medium",children:[(0,i.jsx)("span",{className:"text-lg",children:"\uD83D\uDCE4"}),c&&(d("share.share_result")||"Share"),(0,i.jsx)("span",{className:"text-xs transition-transform ".concat(u?"rotate-180":""),children:"▼"})]}),u&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),(0,i.jsx)("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white/95 backdrop-blur-sm border border-white/30 rounded-lg shadow-xl z-20 animate-fadeInScale",children:(0,i.jsx)("div",{className:"p-2 space-y-1",children:x.map(e=>(0,i.jsxs)("button",{onClick:()=>p(e.id),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-purple-50 rounded flex items-center gap-3 transition-colors",children:[(0,i.jsx)("span",{className:"text-lg",children:e.icon}),(0,i.jsx)("span",{className:"flex-1",children:e.label})]},e.id))})})]})]})}function x(){var e,t,s,x,g,b,f,v,w,y,k,j,N;let{t:S,currentLanguage:C}=(0,a.B)(),{user:D,loading:I}=(0,o.A)(),E=(0,r.useParams)(),_=(0,r.useRouter)(),T=(0,r.useSearchParams)(),R=(0,r.usePathname)(),P=E.testId;console.log("\uD83D\uDD0D TestPage Debug:",{testId:P,testFound:!!(0,l.tb)(P),allTestIds:l.HN.map(e=>e.id),pathname:R,searchParams:Object.fromEntries(T.entries())}),console.log("\uD83D\uDD0D Full test definitions:",l.HN.filter(e=>"knowledge-and-skill"===e.category||"just-for-fun"===e.category));let A=T.get("invitation"),O=T.get("partner"),F=T.get("testResultId"),U=!!(A&&"couple-compatibility"===P),q="couple-compatibility"===P&&!U||"feedback-360"===P,[L,M]=(0,n.useState)(!1),[G,Y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{Y(!0),U&&(console.log("\uD83D\uDE80 Invitation access detected, setting loading to false"),eu(!1));let e=setTimeout(()=>{em&&(console.log("⚠️ Loading timeout - force setting loading to false"),eu(!1))},5e3);return()=>clearTimeout(e)},[U]);let[B,Q]=(0,n.useState)(null),[z,W]=(0,n.useState)(0),[J,K]=(0,n.useState)({}),[V,H]=(0,n.useState)(!1),[X,Z]=(0,n.useState)(null),[$,ee]=(0,n.useState)(!1),[et,es]=(0,n.useState)(""),[ei,ea]=(0,n.useState)(""),[eo,er]=(0,n.useState)(""),[en,el]=(0,n.useState)(!1),[ec,ed]=(0,n.useState)(!1),[em,eu]=(0,n.useState)(!U),[eh,ep]=(0,n.useState)(!1),[ex,eg]=(0,n.useState)(null),[eb,ef]=(0,n.useState)([{name:"",email:""}]),[ev,ew]=(0,n.useState)(""),[ey,ek]=(0,n.useState)(null),[ej,eN]=(0,n.useState)([]),[eS,eC]=(0,n.useState)(null),[eD,eI]=(0,n.useState)(!1),[eE,e_]=(0,n.useState)([]),[eT,eR]=(0,n.useState)({}),[eP,eA]=(0,n.useState)([]),[eO,eF]=(0,n.useState)(!1),[eU,eq]=(0,n.useState)(0),[eL,eM]=(0,n.useState)([]),[eG,eY]=(0,n.useState)(0),[eB,eQ]=(0,n.useState)(!1),[ez,eW]=(0,n.useState)(null),[eJ,eK]=(0,n.useState)({});(0,n.useEffect)(()=>{if(D&&!ev){var e;let t=D.displayName||(null==(e=D.email)?void 0:e.split("@")[0])||"";ew(t),console.log("\uD83D\uDD04 Auto-populated user name:",t)}},[D,ev]),(0,n.useEffect)(()=>{(async()=>{let e="true"===T.get("preserve");if(console.log("\uD83D\uDD0D Result preservation check:",{shouldPreserve:e,hasUser:!!D,authLoading:I,testId:P,searchParams:Object.fromEntries(T.entries())}),e&&D&&!I){console.log("\uD83D\uDD04 User authenticated, checking for results to preserve");try{let e=localStorage.getItem("preserve_test_result");if(console.log("\uD83D\uDD0D Preservation info from localStorage:",e),e){let{testType:t,preserveResult:s}=JSON.parse(e);if(console.log("\uD83D\uDD0D Parsed preservation info:",{testType:t,preserveResult:s,currentTestId:P}),s&&t===P){if(console.log("\uD83D\uDD04 Transferring anonymous results for:",t),await (0,c.nI)(D.uid,t)){console.log("✅ Successfully transferred results, redirecting to results page"),_.push("/".concat(C,"/results"));return}console.log("❌ No results to transfer, staying on test page")}}}catch(e){console.error("❌ Error during result preservation:",e)}let e=new URL(window.location.href);e.searchParams.delete("preserve"),window.history.replaceState({},"",e.toString())}})()},[D,I,T,P,C,_]);let eV=()=>{let e=et.trim().toLowerCase(),t=(T.get("inviterEmail")||"").toLowerCase();return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?void(e===t?(ee(!0),ea("")):ea("ko"===C?"이메일 주소가 일치하지 않습니다. 초대를 보낸 분의 정확한 이메일을 입력해주세요.":"Email address does not match. Please enter the exact email of the person who invited you.")):void ea("ko"===C?"올바른 이메일 형식을 입력해주세요":"Please enter a valid email format"):void ea("ko"===C?"이메일 주소를 입력해주세요":"Please enter an email address")},[eH,eX]=(0,n.useState)(""),[eZ,e$]=(0,n.useState)(""),[e0,e3]=(0,n.useState)(""),[e2,e1]=(0,n.useState)(null),[e5,e4]=(0,n.useState)(!1),[e6,e8]=(0,n.useState)(!1),[e7,e9]=(0,n.useState)(!1),[te,tt]=(0,n.useState)(""),[ts,ti]=(0,n.useState)(!1),[ta,to]=(0,n.useState)(""),[tr,tn]=(0,n.useState)(null),[tl,tc]=(0,n.useState)(!1);(0,n.useEffect)(()=>{console.log("\uD83D\uDD04 Loading test definition for testId:",P);let e=null;"feedback-360"===P?te?(e=(0,l.sQ)(te),console.log("\uD83D\uDCCB Loaded feedback-360 test for category:",te)):(e=(0,l.sQ)("general"),console.log("\uD83D\uDCCB Loaded default feedback-360 test")):console.log("\uD83D\uDCCB Loaded regular test:",(e=(0,l.tb)(P)||null)?"✅ ".concat(e.title_key):"❌ Not found"),e&&(null==B?void 0:B.id)!==e.id?(Q(e),eu(!1),console.log("✅ Test definition set successfully")):e||(console.error("❌ Test not found for ID:",P),eu(!1))},[P,te,null==B?void 0:B.id]);let td=()=>"test_progress_".concat(P,"_").concat((null==D?void 0:D.uid)||"anonymous"),tm=(e,t)=>{let s={testId:P,questionIndex:e,answers:t,timestamp:new Date().toISOString(),totalQuestions:(null==B?void 0:B.questions.length)||0};try{localStorage.setItem(td(),JSON.stringify(s)),console.log("Progress saved: Question ".concat(e+1,"/").concat((null==B?void 0:B.questions.length)||0))}catch(e){console.error("Error saving test progress:",e)}},tu=()=>{try{let e=localStorage.getItem(td());if(e){let t=JSON.parse(e);if(t.testId===P&&t.answers)return{questionIndex:t.questionIndex||0,answers:t.answers||{},timestamp:t.timestamp,totalQuestions:t.totalQuestions}}}catch(e){console.error("Error loading test progress:",e)}return null},th=(e,t)=>{if(!e.trim()&&!t.trim())return"";let s=e.trim(),i=t.trim();switch(C){case"ko":case"ja":case"zh":var a=s+i;if(!a.trim())return"";let o=a.trim();switch(C){case"ko":return o.endsWith("님")?o:"".concat(o,"님");case"ja":return o.endsWith("さん")||o.endsWith("様")||o.endsWith("君")||o.endsWith("ちゃん")?o:"".concat(o,"さん");case"zh":return o;default:return o.split(" ")[0]}default:return i||s}},tp=()=>{try{localStorage.removeItem(td()),console.log("Test progress cleared")}catch(e){console.error("Error clearing test progress:",e)}},tx=async()=>{if(!D)return null;try{if("feedback-360"===P){let t=(await (0,c.iZ)(D.uid)).find(e=>e.testId.startsWith("feedback-360"));if(t)return console.log("Found existing 360\xb0 feedback result in Firestore:",t),t;for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t);if((null==s?void 0:s.startsWith("test_result_"))&&s.includes("feedback-360"))try{let t=localStorage.getItem(s);if(t){var e;let s=JSON.parse(t);if(null==(e=s.testId)?void 0:e.startsWith("feedback-360"))return console.log("Found existing 360\xb0 feedback result in localStorage:",s),s}}catch(e){console.error("Error checking localStorage result:",e)}}}}catch(e){console.error("Error checking for existing results:",e)}return null};(0,n.useEffect)(()=>{if(G&&q&&!I&&!D){let e="/".concat(C,"/tests/").concat(P).concat(U?"?"+T.toString():""),t="feedback-360"===P?"feedback-360-test":"couple-compatibility-test";localStorage.setItem("auth_return_url",e),localStorage.setItem("auth_return_context",t),_.push("/".concat(C,"/auth?returnUrl=").concat(encodeURIComponent(e),"&context=").concat(t));return}},[q,I,D,G,C,P,U,T,_]),(0,n.useEffect)(()=>{if(!G||q&&I)return;let e=null;if("feedback-360"===P){if(!te){ti(!0),eu(!1);return}ts&&ti(!1);try{e=(0,l.sQ)(te)}catch(t){console.error("Error generating feedback360 definition:",t),e=null}if(e){let t="feedback-360-".concat(te);(null==B?void 0:B.id)!==t?Q(e):e=B}}else(e=(0,l.tb)(P)||null)&&(null==B?void 0:B.id)!==e.id?"general-knowledge"===e.id?(async()=>{try{let t=await (0,l.vK)(10,C),s={...e,id:e.id,questions:t.questions};Q(s),e_(t.correctAnswers)}catch(t){console.error("Failed to fetch questions from database, using fallback:",t),Q(e),e_([])}})():"math-speed"===e.id?(async()=>{try{let{questions:t,correctAnswers:s}=await (0,l.oL)(),i={...e,id:e.id,questions:t};Q(i),eR(s),console.log("\uD83D\uDD0D Loaded Math Speed synchronized questions and answers:",{questionCount:t.length,answerCount:Object.keys(s).length,correctAnswers:s})}catch(t){console.error("Failed to fetch math speed questions from database, using fallback:",t),Q(e),eR({})}})():"memory-power"===e.id?(async()=>{try{let t=await (0,l.Xf)(10,C),s={...e,id:e.id,questions:t.questions};Q(s),eA(t.correctAnswers)}catch(t){console.error("Failed to fetch memory power questions from database, using fallback:",t),Q(e),eA([])}})():Q(e):e?"general-knowledge"===e.id?(async()=>{try{let t=await (0,l.vK)(10,C),s={...e,id:e.id,questions:t.questions};Q(s),e_(t.correctAnswers)}catch(t){console.error("Failed to fetch questions from database, using fallback:",t),Q(e),e_([])}})():"math-speed"===e.id?(async()=>{try{let{questions:t,correctAnswers:s}=await (0,l.oL)(),i={...e,id:e.id,questions:t};Q(i),eR(s),console.log("\uD83D\uDD0D Loaded Math Speed synchronized questions and answers:",{questionCount:t.length,answerCount:Object.keys(s).length,correctAnswers:s})}catch(t){console.error("Failed to fetch math speed questions from database, using fallback:",t),Q(e),eR({})}})():"memory-power"===e.id?(async()=>{try{let t=await (0,l.Xf)(10,C),s={...e,id:e.id,questions:t.questions};Q(s),eA(t.correctAnswers)}catch(t){console.error("Failed to fetch memory power questions from database, using fallback:",t),Q(e),eA([])}})():e=B:console.error("Test not found:",P);if(e)if(D&&"feedback-360"===P)tx().then(e=>{if(e){tn(e),tc(!0),eu(!1);return}let t=tu();t&&Object.keys(t.answers).length>0&&(e4(!0),e8(!0)),ev||e5||e9(!0),eu(!1)});else{let e=tu();e&&Object.keys(e.answers).length>0&&(e4(!0),e8(!0)),"feedback-360"!==P||ev||e5||e9(!0),eu(!1)}else"feedback-360"!==P||te?_.push("/".concat(C,"/tests")):eu(!1)},[P,te,G,I]);let tg=e=>{let t=null==B?void 0:B.questions[z];if(!t)return;if((null==B?void 0:B.id)==="math-speed"&&ez){let e=(Date.now()-ez)/1e3;eK(s=>({...s,[t.id]:parseFloat(e.toFixed(2))}))}eQ(!1),eY(0),eW(null);let s={...J,[t.id]:e};if(console.log("\uD83D\uDD0D ANSWER DEBUG:",{questionId:t.id,answer:e,answerType:typeof e,newAnswers:s,testId:null==B?void 0:B.id}),K(s),z<B.questions.length-1){let e=z+1;W(e),tm(e,s)}else tp(),tv(s)},tb=async(e,t,s,i,a)=>{try{console.log("Sending couple results email...",{coupleCompatibility:e,partnerName:i,partnerEmail:a}),console.log("Couple Compatibility Results:",{compatibility:e.compatibilityPercentage+"%",partner1Type:t.type,partner2Type:s.type,areas:e.areas,description:e.description});let o=T.get("inviterEmail");console.log("\uD83D\uDD0D ORIGINAL PARTNER EMAIL RETRIEVAL:",{fromSearchParams:T.get("inviterEmail"),allSearchParams:Object.fromEntries(T.entries()),finalEmail:o}),o&&"unknown@example.com"!==o||(console.error("❌ Cannot send results to original partner - email missing from invitation URL"),console.log("Available search params:",Object.fromEntries(T.entries())));let r=eo||T.get("secondPartnerName")||localStorage.getItem("couple_secondPartnerName")||"Your Partner";console.log("\uD83D\uDD0D PARTNER NAMES:",{firstPartnerName:i,finalSecondPartnerName:r,firstPartnerEmail:o,secondPartnerEmail:a});let n=await (0,c.Bs)(e,o||"missing@example.com",a,i||"Partner 1",r,C);Z({...e,emailSent:n.success,partnerName:i}),n.success?console.log("✅ Couple compatibility results sent via email to both partners"):console.log("⚠️ Email failed - showing results in UI only")}catch(t){console.error("Error sending couple results:",t),Z({...e,emailSent:!1,partnerName:i,error:"Email system unavailable"})}},tf=async(e,t)=>{try{console.log("\uD83C\uDFAF === PARTNER COMPLETION START ==="),console.log("Partner result:",e),console.log("Original test result ID:",F),console.log("Partner name:",O);let s=null;if(F){let e=localStorage.getItem("test_result_".concat(F));e&&(s=JSON.parse(e),console.log("Found original result in localStorage:",s))}if(!s)return void console.warn("Could not find original partner result - sending individual results only");let i=((e,t,s,i)=>{try{if(B&&B.scoring){var a,o,r;let n=B.scoring(s,i);return{compatibilityPercentage:(null==(a=n.scores)?void 0:a.compatibility)||75,partner1:e,partner2:t,areas:(null==(o=n.compatibilityData)?void 0:o.areaScores)||{},description:(null==(r=n.compatibilityData)?void 0:r.description)||"Good compatibility!",recommendations:n.recommendations||[]}}}catch(e){console.error("Error calculating couple compatibility:",e)}return{compatibilityPercentage:75,partner1:e,partner2:t,areas:{communication:80,lifestyle:70,values:75},description:"You have good compatibility potential!",recommendations:["Continue communicating openly","Explore shared interests"]}})(s.result,e,s.answers,t);console.log("Calculated couple compatibility:",i),await tb(i,s.result,e,O||"Your Partner",T.get("email")||"partner@example.com");let a={testId:"couple-compatibility",partnerNames:{partner1:O||"Partner 1",partner2:eo||"Partner 2"},partnerEmails:{partner1:T.get("inviterEmail")||"unknown@example.com",partner2:T.get("email")||"unknown@example.com"},compatibilityResults:i,individualResults:{partner1:s.result,partner2:e},completedAt:new Date().toISOString(),resultType:"couple_compatibility"},o=T.get("inviterEmail"),r=T.get("email");o&&(localStorage.setItem("couple_result_".concat(o),JSON.stringify(a)),console.log("\uD83D\uDCBE Backup saved to localStorage for partner 1:",o)),r&&(localStorage.setItem("couple_result_".concat(r),JSON.stringify(a)),console.log("\uD83D\uDCBE Backup saved to localStorage for partner 2:",r));try{let e={...a,searchKey:"couple_".concat(o,"_").concat(r),partner1Email:o,partner2Email:r,inviter:o,invitee:r,status:"completed"};console.log("\uD83D\uDCBE Attempting to save couple results to 1st test taker database..."),console.log("Search metadata:",{partner1Email:o,partner2Email:r,searchKey:e.searchKey}),await (0,c.jb)(e),console.log("✅ Successfully saved couple results to database")}catch(e){console.error("❌ Failed to save couple results to database:",e),console.log("\uD83D\uDCDD Results are still saved in localStorage as backup")}}catch(e){console.error("Error handling partner completion:",e)}},tv=async e=>{if(!B)return void console.error("Test definition must be available");ep(!0);try{console.log("\uD83D\uDD0D SCORING DEBUG - About to score test:",{testId:P,testDefinitionId:B.id,finalAnswers:e,answerKeys:Object.keys(e),answerValues:Object.values(e),scoringFunction:typeof B.scoring,isMemoryPower:"memory-power"===P,memoryPowerCorrectAnswers:"memory-power"===P?eP:"N/A"});let t=B.scoring(e,void 0,"general-knowledge"===P?eE:"math-speed"===P?eT:"memory-power"===P?eP:void 0,B.questions);console.log("\uD83D\uDD0D SCORING RESULT:",t),e1(t);let s={testId:P,answers:e,result:t,completedAt:new Date().toISOString()};"math-speed"===B.id&&eJ&&(s.responseTimes=eJ),console.log("\uD83D\uDD0D SAVING DEBUG - Local result to save:",{testId:P,hasResult:!!t,resultType:typeof t,resultKeys:t?Object.keys(t):"none",localResult:s});let i="local_"+Date.now();if(localStorage.setItem("test_result_".concat(i),JSON.stringify(s)),console.log("Test saved to localStorage for fallback access"),console.log("User authentication state:",{authenticated:!!D,uid:null==D?void 0:D.uid,email:null==D?void 0:D.email}),D)try{let e=await (0,c.pO)(D.uid,P,s,!1);console.log("Test saved to Firestore successfully with ID:",e),i=e,localStorage.setItem("test_result_".concat(e),JSON.stringify(s)),console.log("Test also saved to localStorage with Firestore ID for consistency")}catch(t){console.error("Error saving to Firestore, using local storage only:",t);let e=t instanceof Error?t.message:"Unknown error";alert("Warning: Test results saved locally only due to sync error: ".concat(e,". Your results are still saved but won't appear in your account history."))}else console.log("Anonymous user - using localStorage only");eg(i),console.log("\uD83D\uDD0D PARTNER COMPLETION CHECK:",{isInvitationAccess:U,testId:P,partnerName:O,shouldTrigger:U&&"couple-compatibility"===P&&O}),U&&"couple-compatibility"===P&&O?(console.log("\uD83C\uDFAF TRIGGERING PARTNER COMPLETION!"),await tf(t,e)):console.log("❌ Partner completion NOT triggered - missing conditions"),H(!0),console.log("Test completed successfully!")}catch(e){console.error("Error processing test completion:",e)}finally{ep(!1)}},tw=async()=>{var e,t;if(!ex)return void alert("ko"===C?"먼저 테스트를 완료해주세요.":"Please complete the test first.");if(!ev.trim())return void alert("ko"===C?"파트너가 누구에 대한 호환성 테스트를 하는지 알 수 있도록 이름을 입력해주세요.":"Please enter your name so your partner knows who they're taking the compatibility test with");if(!ta.trim())return void alert("ko"===C?"파트너의 이름을 입력해주세요.":"Please enter your partner's name");let s=null==(t=eb[0])||null==(e=t.email)?void 0:e.trim();if(!s||!s.includes("@"))return void alert("ko"===C?"파트너의 유효한 이메일 주소를 입력해주세요.":"Please enter your partner's valid email address");let i="invitation_sent_".concat(ex,"_").concat(s),a=localStorage.getItem(i);if(a){let e=parseInt(a);if(Date.now()-e<6e4)return void alert("ko"===C?"최근에 이미 초대장을 보냈습니다. 잠시 후 다시 시도해주세요.":"An invitation was recently sent. Please wait before sending another one.")}try{if(ep(!0),!D)return void alert("ko"===C?"로그인이 필요합니다.":"Authentication required.");console.log("Sending couple compatibility invitation to:",s);let e=await (0,c.sendCoupleCompatibilityInvitation)(D.uid,ex,s,ev.trim(),C||"en",D.email||void 0,ta.trim());if(console.log("Couple compatibility invitation result:",e),e.success&&e.invitations&&e.invitations.length>0){localStorage.setItem(i,Date.now().toString()),e.invitations[0].link;let t="ko"===C?"✅ 파트너 초대가 성공적으로 전송되었습니다!\n\n".concat(s,"님에게 이메일이 발송되었습니다."):"✅ Partner invitation sent successfully!\n\nEmail has been sent to ".concat(s,".");alert(t)}else throw Error("Failed to generate invitation link")}catch(e){console.error("Error sending couple compatibility invitation:",e),alert("ko"===C?"초대 전송 중 오류가 발생했습니다. 다시 시도해주세요.":"Error sending invitation. Please try again.")}finally{ep(!1)}},ty=async()=>{if(console.log("Debug invitation start:",{testResultId:ex,testDefinition:!!B,userName:ev.trim(),feedbackEmails:eb,testId:P,currentLanguage:C,params:E}),!ex)return void alert("ko"===C?"먼저 테스트를 완료해주세요.":"Please complete the test first.");if(!B)return void alert("ko"===C?"테스트 정의를 찾을 수 없습니다.":"Test definition not found.");let e=eb.filter(e=>e.email.trim()&&e.email.includes("@")&&e.name.trim());if(!ev.trim())return void alert("ko"===C?"친구들이 누구에 대한 피드백을 주는지 알 수 있도록 이름을 입력해주세요.":"Please enter your name so friends know who they're giving feedback about");if(0===e.length)return void alert("ko"===C?"유효한 이름과 이메일 주소를 최소 하나 이상 입력해주세요.":"Please enter at least one valid name and email address");try{if(ep(!0),!D)return void alert("ko"===C?"로그인이 필요합니다.":"Authentication required.");console.log("About to call sendFeedbackInvitations with language:",C),console.log("Selected category for feedback:",te);let t=await (0,c.Af)(D.uid,P,ex,e,ev.trim(),te,C||"en",D.email||void 0);if(t.success&&t.invitations)console.log("Email sending delegated to sendFeedbackInvitations function - skipping duplicate EmailJS calls"),alert("ko"===C?"이메일 초대장이 성공적으로 발송되었습니다!\n\n".concat(e.length,"개의 이메일이 발송되었습니다. 참가자들이 이메일을 확인하여 피드백을 제공할 수 있습니다."):"Email invitations sent successfully!\n\n".concat(e.length," emails have been sent. Participants can check their email to provide feedback.")),_.push("/".concat(C,"/results"));else throw Error("Failed to generate invitation links")}catch(t){console.error("Error generating invitations:",t);let e=t instanceof Error?t.message:"Unknown error";console.error("Detailed error:",e),alert("ko"===C?"초대장 생성 중 오류가 발생했습니다: ".concat(e,"\n\n다시 시도해주세요."):"Error generating invitations: ".concat(e,"\n\nPlease try again."))}finally{ep(!1)}};(0,n.useEffect)(()=>{if(q&&G){if(console.log("\uD83D\uDD10 Enhanced auth check:",{testId:P,authLoading:I,hasUser:!!D,isClient:G}),!I&&!D){console.log("\uD83D\uDEA8 REDIRECTING: Protected test without authentication");let e=encodeURIComponent("/".concat(C,"/tests/").concat(P));_.push("/".concat(C,"/auth?returnUrl=").concat(e));return}I||M(!0)}else q||M(!0)},[q,G,I,D,_,C,P]),(0,n.useEffect)(()=>{q&&!I&&!D&&G&&(console.log("\uD83D\uDEA8 SAFETY REDIRECT: Unauthorized access attempt"),_.push("/".concat(C,"/auth?returnUrl=").concat(encodeURIComponent("/".concat(C,"/tests/").concat(P)))))},[q,I,D,G,C,P,_]),(0,n.useEffect)(()=>{if(B&&"memory-power"===B.id){let e=B.questions[z];(null==e?void 0:e.memoryPhase)&&!eO&&!J[e.id]&&(eM(e.memoryPhase.content||(e.memoryPhase.text_key?e.memoryPhase.text_key.split(", "):[])),eF(!0),eq(Math.floor(e.memoryPhase.duration/1e3)))}},[B,z,J]),(0,n.useEffect)(()=>{if(eO){let e=setInterval(()=>{eq(t=>t<=1?(clearInterval(e),eF(!1),0):t-1)},1e3);return()=>clearInterval(e)}},[eO]),(0,n.useEffect)(()=>{if(B&&["general-knowledge","math-speed"].includes(B.id)){let e=B.questions[z];!e||J[e.id]||eO||(eY(10),eQ(!0),"math-speed"===B.id&&eW(Date.now()))}},[B,z,J,eO]),(0,n.useEffect)(()=>{if(eB&&eG>0){let e=setInterval(()=>{eY(t=>t<=1?(clearInterval(e),eQ(!1),setTimeout(()=>{let e=null==B?void 0:B.questions[z];e&&!J[e.id]?(console.log("\uD83D\uDD0D TIMER AUTO-SUBMIT: Question timed out, submitting null"),tg(null)):console.log("\uD83D\uDD0D TIMER SKIP: Question already answered, not auto-submitting")},100),0):t-1)},1e3);return()=>clearInterval(e)}},[eB,eG,B,z,J]);let tk=(e,t)=>{let s=[...eb];s[e]={...s[e],email:t},ef(s)},tj=(e,t)=>{let s=[...eb];s[e]={...s[e],name:t},ef(s)};if(q&&(!G||I||!D)){if(!I&&!D&&G){let e=encodeURIComponent("/".concat(C,"/tests/").concat(P));_.push("/".concat(C,"/auth?returnUrl=").concat(e))}return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-lg text-white",children:I||D?"ko"===C?"인증 확인 중...":"Checking authentication...":"ko"===C?"로그인 페이지로 이동 중...":"Redirecting to login..."})]})})}if(console.log("\uD83D\uDD0D Render State Debug:",{loading:em,isInvitationAccess:U,testDefinition:!!B,showCategorySelection:ts,showExistingResultOptions:tl,authLoading:I,user:!!D,testCompleted:V,currentTestId:P}),em&&!U)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-lg text-white",children:"ko"===C?"테스트 로딩 중...":"ja"===C?"テスト読み込み中...":"zh"===C?"正在加载测试...":"Loading test..."})]})});if(tl&&tr&&"feedback-360"===P)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"w-full max-w-2xl p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg text-center",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold mb-4 text-white",children:["\uD83C\uDFAF ","ko"===C?"이미 완료된 360\xb0 피드백이 있습니다!":"You already have a completed 360\xb0 Feedback!"]}),(0,i.jsx)("p",{className:"text-lg text-white/90 mb-4",children:"ko"===C?"다음 중 원하는 옵션을 선택해주세요:":"Please choose what you would like to do:"}),(0,i.jsx)("div",{className:"text-sm text-white/70 mb-6",children:"ko"===C?"완료 날짜: ".concat(new Date(tr.completedAt||(null==(e=tr.result)?void 0:e.completedAt)||Date.now()).toLocaleDateString("ko-KR")):"Completed: ".concat(new Date(tr.completedAt||(null==(t=tr.result)?void 0:t.completedAt)||Date.now()).toLocaleDateString())})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("button",{onClick:()=>{_.push("/".concat(C,"/results"))},className:"w-full py-4 px-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 text-lg shadow-lg",children:["\uD83D\uDCCA ","ko"===C?"결과 보기":"View Results"]}),(0,i.jsxs)("button",{onClick:()=>{e1(tr.result||tr),eg(tr.id||"existing"),H(!0),tc(!1)},className:"w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 text-lg shadow-lg",children:["\uD83D\uDCE7 ","ko"===C?"피드백 초대장 보내기":"Send Feedback Invitations"]}),(0,i.jsxs)("button",{onClick:()=>{window.confirm("ko"===C?"정말 테스트를 다시 받으시겠습니까? 기존 결과는 유지됩니다.":"Are you sure you want to retake the test? Your existing results will be kept.")&&(tn(null),tc(!1),ti(!0))},className:"w-full py-4 px-6 bg-gradient-to-r from-yellow-500 to-orange-600 text-white font-bold rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 transform hover:scale-105 text-lg shadow-lg",children:["\uD83D\uDD04 ","ko"===C?"테스트 다시 받기":"Retake Test"]}),(0,i.jsxs)("button",{onClick:()=>{_.push("/".concat(C,"/tests"))},className:"w-full py-3 px-6 bg-gray-500/70 text-white font-medium rounded-lg hover:bg-gray-600/70 transition-colors duration-200",children:["← ","ko"===C?"테스트 목록으로 돌아가기":"Back to Test List"]})]})]})});if(ts&&"feedback-360"===P){console.log("=== CATEGORY TRANSLATION DEBUG ==="),console.log("Current language:",C),console.log("Translation test - work:",S("tests.feedback360.categories.work")),console.log("Translation test - friends:",S("tests.feedback360.categories.friends")),console.log("=== END TRANSLATION DEBUG ===");let e="ko"===C;return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-4",children:(0,i.jsxs)("div",{className:"max-w-md w-full bg-white/95 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg p-8",children:[D&&(0,i.jsxs)("div",{className:"mb-6 text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,i.jsx)("div",{className:"text-green-600 text-sm font-medium mb-1",children:"ko"===C?"로그인됨":"Logged in as"}),(0,i.jsx)("div",{className:"text-gray-800 font-semibold",children:D.displayName||D.email||"User"}),(0,i.jsxs)("div",{className:"text-green-600 text-xs mt-1",children:["✓ ","ko"===C?"인증 완료":"Authenticated"]})]}),(0,i.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-800 text-center",children:S("tests.feedback360.title")}),(0,i.jsx)("p",{className:"text-gray-600 mb-6 text-center",children:"ko"===C?"먼저 피드백을 받을 관계 카테고리를 선택해주세요:":"First, please select a relationship category for feedback:"}),(0,i.jsx)("div",{className:"space-y-3",children:[{key:"work",label:e?"직장 동료":"Work Colleagues"},{key:"friends",label:e?"친구":"Friends"},{key:"family",label:e?"가족":"Family"},{key:"academic",label:e?"학업 파트너":"Academic Partners"},{key:"general",label:e?"일반적 관계":"General Relationships"}].map(e=>(0,i.jsx)("button",{onClick:()=>{tt(e.key),ti(!1)},className:"w-full p-4 text-left bg-gray-50 hover:bg-indigo-50 border border-gray-200 rounded-lg transition-all duration-200 hover:border-indigo-300",children:(0,i.jsx)("div",{className:"font-medium text-gray-800",children:e.label})},e.key))})]})})}if(!B)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4 text-white",children:"ko"===C?"테스트를 찾을 수 없습니다":"ja"===C?"テストが見つかりません":"zh"===C?"未找到测试":"Test Not Found"}),(0,i.jsx)("button",{onClick:()=>_.push("/".concat(C,"/tests")),className:"p-4 bg-white text-purple-600 font-bold rounded-lg hover:bg-purple-50 transition-all",children:"ko"===C?"테스트로 돌아가기":"ja"===C?"テストに戻る":"zh"===C?"回到测试":"Back to Tests"})]})});if("feedback-360"===P&&!ev)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"w-full max-w-2xl p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg text-center",children:[D&&(0,i.jsxs)("div",{className:"mb-6 p-4 bg-white/10 border border-white/30 rounded-lg backdrop-blur-sm",children:[(0,i.jsx)("div",{className:"text-green-300 text-sm font-medium mb-1",children:"ko"===C?"안녕하세요!":"Hello!"}),(0,i.jsx)("div",{className:"text-white font-semibold text-lg",children:D.displayName||D.email||"User"}),(0,i.jsxs)("div",{className:"text-green-300 text-xs mt-1",children:["✓ ","ko"===C?"로그인 완료":"Successfully logged in"]})]}),(0,i.jsxs)("h1",{className:"text-3xl font-bold mb-4 text-white",children:["\uD83C\uDF1F ",S("ui.feedback360Title")||"360\xb0 Feedback Assessment"]}),(0,i.jsx)("p",{className:"text-lg text-white/90 mb-6",children:S("ui.feedback360Description")||"This assessment helps you understand how others see you. Friends, family, and colleagues will answer questions about you personally."}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("label",{className:"block text-lg font-medium mb-3 text-white",children:S("ui.enterYourName")||"What should we call you?"}),(0,i.jsxs)("div",{className:"mb-4 p-3 bg-white/10 rounded-lg text-sm text-white/70",children:[(0,i.jsx)("p",{className:"font-medium mb-2",children:S("ui.examples")||"Examples:"}),(0,i.jsx)("div",{className:"text-xs",children:"ko"===C?(0,i.jsx)("div",{children:"• 성: 김, 이름: 철수"}):"ja"===C?(0,i.jsx)("div",{children:"• 姓: 田中, 名: 太郎"}):"zh"===C?(0,i.jsx)("div",{children:"• 姓: 王, 名: 小明"}):(0,i.jsx)("div",{children:"• First: Sarah, Last: Johnson"})})]}),(0,i.jsx)("div",{className:"space-y-3 mb-4",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-1 text-white/80",children:S("ui.lastNameKo")||"Last Name"}),(0,i.jsx)("input",{type:"text",value:e0,onChange:e=>e3(e.target.value),placeholder:"ko"===C?"김":"ja"===C?"田中":"zh"===C?"王":"Johnson",className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50",autoFocus:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-1 text-white/80",children:S("ui.firstNameKo")||"First Name"}),(0,i.jsx)("input",{type:"text",value:eZ,onChange:e=>e$(e.target.value),placeholder:"ko"===C?"철수":"ja"===C?"太郎":"zh"===C?"小明":"Sarah",className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50"})]})]})}),(0,i.jsx)("p",{className:"text-sm text-white/60 mt-2",children:"ko"===C?'질문 예시: "'.concat(th(e0,eZ)||"김철수님",'은(는) 사람들의 마음을 사로잡는 것을 잘하나요?"'):'Question example: "Is '.concat(th(e0,eZ)||"your name",' good at captivating people?"')})]}),(0,i.jsx)("button",{onClick:()=>{e0.trim()||eZ.trim()?(ew(th(e0,eZ)),e9(!1)):alert("ko"===C?"이름을 입력해 주세요":"ja"===C?"名前を入力してください":"Please enter your name to continue")},disabled:!e0.trim()&&!eZ.trim(),className:"px-8 py-4 bg-gradient-to-r from-green-500 to-blue-600 text-white font-bold rounded-lg hover:from-green-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:S("ui.startAssessment")||"Start Assessment ✨"}),(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)("button",{onClick:()=>_.push("/".concat(C,"/tests")),className:"text-white/60 hover:text-white/80 text-sm underline",children:S("ui.backToTests")||"Back to Tests"})})]})});if(e6&&e5){let e=tu(),t=e?Math.round(Object.keys(e.answers).length/(e.totalQuestions||1)*100):0;return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"w-full max-w-2xl p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg text-center",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold mb-4 text-white",children:["\uD83D\uDD04 ",S("ui.resumeTestTitle")||"Resume Your Test?"]}),(0,i.jsxs)("p",{className:"text-lg text-white/90 mb-2",children:[S("ui.testInProgress")||"You have a test in progress for"," ",(0,i.jsx)("strong",{children:S(B.title_key)||B.title_key})]}),(0,i.jsxs)("p",{className:"text-white/80 mb-6",children:[S("ui.completedQuestions")||"You've completed"," ",Object.keys((null==e?void 0:e.answers)||{}).length," ",S("ui.outOf")||"out of"," ",B.questions.length," ",S("ui.questions")||"questions"]}),(0,i.jsx)("div",{className:"w-full bg-white/20 rounded-full h-4 mb-6",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-4 rounded-full transition-all duration-1000 ease-out",style:{width:"".concat(t,"%")}})}),(0,i.jsx)("p",{className:"text-sm text-white/70 mb-8",children:(null==e?void 0:e.timestamp)&&"".concat(S("ui.lastUpdated")||"Last updated:"," ").concat(new Date(e.timestamp).toLocaleString())})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,i.jsxs)("button",{onClick:()=>{let e=tu();e&&(W(e.questionIndex),K(e.answers),e4(!1),e8(!1),console.log("Resumed from question ".concat(e.questionIndex+1)))},className:"px-8 py-4 bg-gradient-to-r from-green-500 to-blue-600 text-white font-bold rounded-lg hover:from-green-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 text-lg",children:["\uD83D\uDE80 ",S("ui.resumeTest")||"Resume Test"," (",t,S("ui.percentComplete")||"% complete",")"]}),(0,i.jsxs)("button",{onClick:()=>{tp(),W(0),K({}),e4(!1),e8(!1),console.log("Started fresh test")},className:"px-8 py-4 bg-white/20 backdrop-blur-sm border border-white/30 text-white font-semibold rounded-lg hover:bg-white/30 transition-all duration-300",children:["\uD83D\uDD04 ",S("ui.startFresh")||"Start Fresh"]})]}),(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)("button",{onClick:()=>_.push("/".concat(C,"/tests")),className:"text-white/60 hover:text-white/80 text-sm underline",children:S("ui.backToTests")||"Back to Tests"})})]})})}if(V)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"text-center w-full max-w-2xl p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold mb-4 text-white","data-translate":"test.completed_title",children:U&&O?"\uD83D\uDC95 Thanks for taking ".concat(O,"'s compatibility test!"):S("test.completed_title")||"Test Completed!"}),U&&O&&(0,i.jsxs)("div",{className:"mb-6 p-4 bg-pink-500/30 border border-pink-400/50 rounded-lg",children:[(0,i.jsx)("p",{className:"text-white text-lg mb-3",children:"ko"===C?"".concat(O,"님과의 커플 호환성 결과를 확인하세요!"):"Check your compatibility results with ".concat(O,"!")}),(0,i.jsx)("div",{className:"text-sm text-white/80",children:"ko"===C?"결과가 아래에 표시됩니다.":"Results are shown below."})]}),(console.log("\uD83D\uDD0D COUPLE RESULTS DEBUG:",{coupleCompatibilityResults:!!X,isInvitationAccess:U,shouldShowResults:X&&U}),X&&console.log("Couple results data:",X),null),X&&U&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-br from-pink-500/30 to-purple-500/30 border border-pink-400/50 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-white mb-4 text-center",children:"\uD83D\uDC95 Couple Compatibility Results"}),(0,i.jsxs)("div",{className:"text-center mb-6",children:[(0,i.jsxs)("div",{className:"text-4xl font-bold text-white mb-2",children:[X.compatibilityPercentage,"%"]}),(0,i.jsx)("div",{className:"text-xl text-white/90",children:X.description})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,i.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,i.jsx)("div",{className:"font-semibold text-white mb-1",children:X.partnerName}),(0,i.jsx)("div",{className:"text-white/80",children:null==(s=X.partner1)?void 0:s.type})]}),(0,i.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,i.jsx)("div",{className:"font-semibold text-white mb-1",children:"You"}),(0,i.jsx)("div",{className:"text-white/80",children:null==(x=X.partner2)?void 0:x.type})]})]}),X.areas&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("div",{className:"font-semibold text-white mb-2",children:"Compatibility Areas:"}),Object.entries(X.areas).map(e=>{let[t,s]=e;return(0,i.jsxs)("div",{className:"flex justify-between text-white/90 mb-1",children:[(0,i.jsxs)("span",{children:[t,":"]}),(0,i.jsxs)("span",{children:[s,"%"]})]},t)})]}),(0,i.jsx)("div",{className:"text-center text-sm text-white/70",children:X.emailSent?"✅ Results also sent via email to both partners":"⚠️ Email system temporarily unavailable - results shown here"})]}),U&&O&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-br from-purple-500/30 to-pink-500/30 border border-purple-400/50 rounded-lg",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold text-white mb-4 text-center",children:["\uD83D\uDD0D ","ko"===C?"상세 호환성 분석을 보시겠어요?":"Want to See Detailed Compatibility Analysis?"]}),(0,i.jsxs)("div",{className:"text-center mb-6",children:[(0,i.jsx)("p",{className:"text-white/90 text-lg mb-4",children:"ko"===C?"".concat(O,"님과의 심화 분석 결과를 확인하세요:"):"Unlock in-depth analysis with ".concat(O,":")}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-left text-white/80 text-sm mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-green-400 mr-2",children:"✅"}),(0,i.jsx)("span",{children:"ko"===C?"15개 질문별 답변 비교":"Question-by-question answer comparison"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-green-400 mr-2",children:"✅"}),(0,i.jsx)("span",{children:"ko"===C?"상세 호환성 분석 보고서":"Detailed compatibility report"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-green-400 mr-2",children:"✅"}),(0,i.jsx)("span",{children:"ko"===C?"관계 개선 제안사항":"Relationship improvement suggestions"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-green-400 mr-2",children:"✅"}),(0,i.jsx)("span",{children:"ko"===C?"결과 저장 및 재열람":"Save results for future access"})]})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,i.jsx)("button",{onClick:()=>{D?_.push("/".concat(C,"/results?comparison=true&partner=").concat(encodeURIComponent(O))):_.push("/".concat(C,"/auth?redirect=").concat(encodeURIComponent("/".concat(C,"/results?comparison=true&partner=").concat(encodeURIComponent(O))),"&action=signup"))},className:"px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 text-lg",children:D?"ko"===C?"\uD83D\uDD0D 상세 분석 보기":"\uD83D\uDD0D View Detailed Analysis":"ko"===C?"\uD83D\uDD0D 상세 분석 보기 (무료 가입)":"\uD83D\uDD0D View Detailed Analysis (Free Signup)"}),(0,i.jsx)("button",{onClick:()=>{_.push("/".concat(C))},className:"px-6 py-4 bg-white/10 backdrop-blur-sm border border-white/30 text-white rounded-lg hover:bg-white/20 transition-all duration-300",children:"ko"===C?"나중에 하기":"Skip for Now"})]}),(0,i.jsx)("p",{className:"text-xs text-white/60 mt-4",children:"ko"===C?"기본 결과는 이미 이메일로 전송되었습니다. 가입 후 더 자세한 분석을 확인하세요.":"Basic results already sent via email. Sign up to access detailed partner comparison."})]})]}),e2&&(0,i.jsxs)("div",{className:"mb-8 bg-white/15 backdrop-blur-xl border border-white/20 rounded-3xl overflow-hidden shadow-2xl",children:[(0,i.jsxs)("div",{className:"text-center py-8 px-6 bg-gradient-to-br from-white/10 to-white/5",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-3 text-gray-200","data-translate":"results.personalityType",children:S("results.personalityType")||"Your Personality Type"}),e2.type&&(0,i.jsx)("div",{className:"text-4xl lg:text-5xl font-bold text-white mb-4 text-enhanced",children:"couple-compatibility"===P?S("couple.personalityTypes.".concat(e2.type))||e2.type:S(e2.type)||e2.type}),e2.description_key&&(0,i.jsx)("p",{className:"text-gray-100 text-lg leading-relaxed max-w-2xl mx-auto text-enhanced",children:S(e2.description_key)||e2.description_key})]}),e2.scores&&(0,i.jsxs)("div",{className:"px-6 pb-8",children:[("spirit-animal"===P||"country-match"===P||"mental-age"===P)&&(0,i.jsx)("div",{className:"grid gap-4 max-w-md mx-auto",children:Object.entries(e2.scores).filter(e=>{let[t]=e;return!["allScores"].includes(t)}).map(e=>{let[t,s]=e;return"animal"===t||"country"===t||"mentalAge"===t||"animalData"===t||"countryData"===t||"description"===t||"category"===t||"emoji"===t||"ageRange"===t?null:(0,i.jsxs)("div",{className:"text-center py-3 px-4 bg-white/10 backdrop-blur-sm rounded-2xl border border-white/20",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-200 mb-1",children:S("results.dimensions.".concat(t))||t}),(0,i.jsx)("div",{className:"text-2xl font-bold text-white text-enhanced",children:"number"==typeof s?s:String(s)})]},t)})}),"spirit-animal"!==P&&"country-match"!==P&&"mental-age"!==P&&(0,i.jsxs)("div",{children:[e2.scores.percentages&&(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-200 mb-6 text-center","data-translate":"results.keyTraits",children:S("results.keyTraits")||"Your Key Traits"}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-4xl mx-auto",children:e2.scores.percentages?Object.entries(e2.scores.percentages).map(e=>{let[t,s]=e;return(0,i.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm p-5 rounded-2xl border border-white/20",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,i.jsx)("div",{className:"font-semibold text-lg text-gray-100",children:S("results.bigfive.traits.".concat(t))||S("results.dimensions.".concat(t))||t}),(0,i.jsxs)("div",{className:"text-2xl font-bold text-white",children:["number"==typeof s?s:0,"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-white/10 rounded-full h-2",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-emerald-400 to-cyan-400 h-2 rounded-full transition-all duration-1000 ease-out",style:{width:"".concat("number"==typeof s?s:0,"%")}})})]},t)}):Object.entries(e2.scores).filter(e=>{let[t]=e;return!["correctAnswers","level","description","allScores"].includes(t)}).slice(0,4).map(e=>{let[t,s]=e;return(0,i.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm p-5 rounded-2xl border border-white/20 text-center",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-200 mb-2",children:S("results.dimensions.".concat(t))||t}),(0,i.jsx)("div",{className:"text-2xl font-bold text-white",children:"number"==typeof s?s:String(s).slice(0,20)})]},t)})})]})]})]}),e2&&"math-speed"===P&&eJ&&Object.keys(eJ).length>0&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-r from-blue-500/30 to-cyan-500/30 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white",children:["⚡ ","ko"===C?"응답 시간 분석":"Response Time Analysis"]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(eJ).map((e,t)=>{let[s,a]=e;return(0,i.jsx)("div",{className:"bg-white/20 p-3 rounded-lg backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"text-white/80 text-sm",children:"ko"===C?"문제 ".concat(t+1):"Question ".concat(t+1)}),(0,i.jsxs)("span",{className:"text-white font-bold",children:[a,"s"]})]})},s)})}),(0,i.jsx)("div",{className:"mt-4 p-3 bg-white/10 rounded-lg",children:(0,i.jsxs)("div",{className:"flex justify-between items-center text-white",children:[(0,i.jsx)("span",{className:"font-semibold",children:"ko"===C?"평균 응답 시간:":"Average Response Time:"}),(0,i.jsxs)("span",{className:"font-bold text-cyan-300",children:[(Object.values(eJ).reduce((e,t)=>e+t,0)/Object.values(eJ).length).toFixed(2),"s"]})]})})]}),e2&&e2.traits&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white","data-translate":"results.keyTraits",children:["✨ ",S("results.keyTraits")||"Your Key Traits"]}),(0,i.jsx)("div",{className:"flex flex-wrap gap-3",children:e2.traits.map((e,t)=>(0,i.jsx)("span",{className:"px-4 py-2 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-full text-sm font-medium",children:"couple-compatibility"===P?S("couple.traits.".concat(e))||e:S(e)||e},t))})]}),e2&&e2.strengths&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white",children:["\uD83D\uDCAA ",S("results.strengths")||"Your Strengths"]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:e2.strengths.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center text-white/90",children:[(0,i.jsx)("span",{className:"text-green-400 mr-2",children:S("results.strengthPrefix")||"✓"}),S("results.dimensions.".concat(e))||e]},t))})]}),e2&&e2.recommendations&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white",children:["\uD83C\uDFAF ",S("results.growthOpportunities")||"Growth Opportunities"]}),(0,i.jsx)("div",{className:"space-y-3",children:e2.recommendations.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-start text-white/90",children:[(0,i.jsx)("span",{className:"text-blue-400 mr-2 mt-1",children:S("results.developmentPrefix")||"\uD83D\uDCA1"}),(0,i.jsx)("span",{children:S("results.dimensions.".concat(e))||e})]},t))})]}),e2&&e2.description_key&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-r from-purple-500/30 to-pink-500/30 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,i.jsxs)("h3",{className:"text-xl font-bold mb-4 text-white",children:["\uD83E\uDDE0 ",S("results.aboutType")||"About Your Type"]}),(0,i.jsx)("p",{className:"text-white/90 text-lg leading-relaxed",children:S(e2.description_key)||e2.description_key})]}),(0,i.jsx)(d,{testType:P,personalityType:null==e2?void 0:e2.type}),B.requiresFeedback&&!U&&(console.log("\uD83D\uDD0D INVITATION SECTION DEBUG:",{requiresFeedback:B.requiresFeedback,isInvitationAccess:U,testId:P,shouldShow:B.requiresFeedback&&!U}),!0)&&(0,i.jsxs)("div",{className:"mb-8 p-6 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:["couple-compatibility"===P?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("h2",{className:"text-xl font-bold mb-4 text-white",children:["\uD83D\uDC95 ",S("test.invite_partner_title")||"Invite Your Partner"]}),(0,i.jsx)("p",{className:"text-sm mb-4 text-white/80",children:S("test.invite_partner_description")||"Send an invitation to your partner to complete their part of the compatibility test. You'll both receive the results once they finish."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4 text-white","data-translate":"test.invite_feedback_title",children:S("test.invite_feedback_title")||"Invite Others for Feedback"}),(0,i.jsx)("p",{className:"text-sm mb-4 text-white/80","data-translate":"test.invite_feedback_description",children:S("test.invite_feedback_description")||"Get a complete picture by inviting friends and colleagues to provide feedback about you."})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2 text-white",children:"couple-compatibility"===P?S("test.your_name_for_partner")||"Your name (so your partner knows who invited them)":S("feedbackInvite.nameQuestion")||"What name should your friends use when giving feedback?"}),(0,i.jsx)("input",{type:"text",value:ev,onChange:e=>ew(e.target.value),placeholder:"Enter your first name (e.g., Sarah, Mike)",className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50"}),(0,i.jsx)("p",{className:"text-xs text-white/60 mt-1",children:ev?"".concat(S("feedbackInvite.exampleText")||"Questions will be like:",' "').concat(ev.endsWith("님")?ev.slice(0,-1):ev).concat(S("feedbackInvite.exampleQuestion")||S("feedbackInvite.exampleQuestionFallback")||" good at getting people excited about stuff they want to do?",'"'):"".concat(S("feedbackInvite.exampleText")||"Questions will be like:",' "[').concat(S("ui.yourName")||"your name","]").concat(S("feedbackInvite.exampleQuestion")||S("feedbackInvite.exampleQuestionFallback")||" good at getting people excited about stuff they want to do?",'"')})]}),"couple-compatibility"===P?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2 text-white",children:S("test.partner_name")||"Your Partner's Name"}),(0,i.jsx)("input",{type:"text",value:ta||"",onChange:e=>to(e.target.value),placeholder:S("test.partner_name_placeholder")||"Enter your partner's first name (e.g., Sarah, Mike)",className:"w-full p-3 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 backdrop-blur-sm"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2 text-white",children:S("test.partner_email")||"Your Partner's Email Address"}),(0,i.jsx)("input",{type:"email",value:(null==(g=eb[0])?void 0:g.email)||"",onChange:e=>tk(0,e.target.value),placeholder:S("test.partner_email_placeholder")||"Enter your partner's email address",className:"w-full p-3 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 backdrop-blur-sm"})]}),(0,i.jsx)("div",{className:"flex justify-center mb-4",children:(0,i.jsx)("button",{onClick:tw,disabled:eh,className:"px-6 py-3 bg-gradient-to-r from-pink-500 to-red-500 text-white font-semibold rounded-lg hover:from-pink-600 hover:to-red-600 disabled:opacity-50 transition-all duration-300",children:eh?S("test.sending_invitation")||"Sending Invitation...":S("test.send_partner_invitation")||"\uD83D\uDC95 Send Partner Invitation"})})]}):(0,i.jsx)(i.Fragment,{children:ey?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("h3",{className:"text-lg font-bold text-white",children:["email"===ey&&(S("invitation.email.title")||"\uD83D\uDCE7 Email Invitations"),"codes"===ey&&(S("invitation.codes.title")||"\uD83D\uDD11 Anonymous Codes"),"link"===ey&&(S("invitation.link.title")||"\uD83D\uDD17 Shareable Link"),"mixed"===ey&&(S("invitation.mixed.title")||"\uD83C\uDFAF Multiple Methods")]}),(0,i.jsx)("button",{onClick:()=>ek(null),className:"px-3 py-1 text-sm bg-white/20 hover:bg-white/30 text-white rounded transition-colors duration-300",children:S("invitation.change_method")||"Change Method"})]}),"email"===ey&&(0,i.jsxs)("div",{className:"space-y-4",children:[eb.map((e,t)=>(0,i.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg border border-white/20",children:[(0,i.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,i.jsx)("input",{type:"text",value:e.name,onChange:e=>tj(t,e.target.value),placeholder:S("feedbackInvite.namePlaceholder")||"Enter name (e.g., John, Sarah)",className:"flex-1 p-2 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 backdrop-blur-sm"}),eb.length>1&&(0,i.jsx)("button",{onClick:()=>{eb.length>1&&ef(eb.filter((e,s)=>s!==t))},className:"p-2 text-red-500 hover:text-red-700 bg-white/10 rounded",title:"Remove this person",children:"✕"})]}),(0,i.jsx)("input",{type:"email",value:e.email,onChange:e=>tk(t,e.target.value),placeholder:S("feedbackInvite.emailPlaceholder")||"Enter email address",className:"w-full p-2 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 backdrop-blur-sm"})]},t)),(0,i.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,i.jsx)("button",{onClick:()=>{ef([...eb,{name:"",email:""}])},className:"px-4 py-2 text-sm bg-white/20 text-white rounded hover:bg-white/30 backdrop-blur-sm border border-white/30 transition-all duration-300",children:S("feedbackInvite.addAnother")||"Add Another Person"}),(0,i.jsx)("button",{onClick:ty,disabled:eh,className:"px-4 py-2 text-sm bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded hover:from-blue-600 hover:to-purple-600 disabled:opacity-50 backdrop-blur-sm border border-white/20 transition-all duration-300",children:eh?S("feedbackInvite.sending")||"Sending...":S("feedbackInvite.sendInvitations")||"Send Invitations"})]})]}),"codes"===ey&&(0,i.jsx)(u,{testResultId:ex||"",testId:P,userName:ev,onCodesGenerated:e=>{eN(e),console.log("Generated codes:",e)}}),"link"===ey&&(0,i.jsx)(h,{testResultId:ex||"",testId:P,userName:ev,onLinkGenerated:e=>{eC(e),console.log("Generated link:",e)}}),"mixed"===ey&&(0,i.jsxs)("div",{className:"space-y-8",children:[(0,i.jsx)("div",{className:"text-center mb-6",children:(0,i.jsx)("p",{className:"text-white/80",children:S("invitation.mixed.description")||"Use different methods for different people and situations"})}),(0,i.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/20",children:[(0,i.jsx)("h4",{className:"text-md font-bold text-white mb-3",children:"\uD83D\uDCE7 Email Invitations"}),(0,i.jsxs)("div",{className:"space-y-2",children:[eb.slice(0,2).map((e,t)=>(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{type:"text",value:e.name,onChange:e=>tj(t,e.target.value),placeholder:"Name",className:"flex-1 p-2 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 text-sm"}),(0,i.jsx)("input",{type:"email",value:e.email,onChange:e=>tk(t,e.target.value),placeholder:"Email",className:"flex-2 p-2 bg-white/10 border border-white/30 rounded text-white placeholder-white/60 text-sm"})]},t)),(0,i.jsx)("button",{onClick:ty,disabled:eh,className:"w-full px-3 py-2 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors duration-300",children:"Send Email Invitations"})]})]}),(0,i.jsx)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/20",children:(0,i.jsx)(u,{testResultId:ex||"",testId:P,userName:ev,onCodesGenerated:eN})}),(0,i.jsx)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/20",children:(0,i.jsx)(h,{testResultId:ex||"",testId:P,userName:ev,onLinkGenerated:eC})})]})]}):(0,i.jsx)(m,{onMethodSelect:e=>{ek(e),console.log("Selected invitation method:",e)},testId:P})})]}),e2&&B&&(0,i.jsx)("div",{className:"mt-8 mb-8",children:(0,i.jsx)(p,{testId:P,testName:B.title_key?S(B.title_key)||B.title_key:"Personality Test",result:e2,variant:"grid",className:"max-w-2xl mx-auto"})}),(0,i.jsx)("div",{className:"flex justify-center mt-8",children:(0,i.jsx)("button",{onClick:()=>_.push("/".concat(C,"/tests")),className:"p-4 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-all text-xl","data-translate":"test.take_another",children:S("test.take_another")||"Take Another Test"})})]})});if(eh)return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-lg text-white",children:"Saving your results..."})]})});let tN=B.questions[z];return["spirit-animal","mental-age","country-match"].includes(P)&&tN&&(console.log("\uD83D\uDD0D ".concat(P.toUpperCase()," Question Debug:"),{questionIndex:z,questionId:tN.id,hasOptions:!!tN.options,optionsCount:null==(b=tN.options)?void 0:b.length,firstOptionValue:null==(v=tN.options)||null==(f=v[0])?void 0:f.value,lastOptionValue:null==(k=tN.options)||null==(w=k[(null==(y=tN.options)?void 0:y.length)-1])?void 0:w.value,allOptionValues:null==(j=tN.options)?void 0:j.map(e=>e.value),allOptionTextKeys:null==(N=tN.options)?void 0:N.map(e=>e.text_key)}),console.log("\uD83D\uDD0D ".concat(P.toUpperCase()," Options Detail:"),tN.options)),console.log("Debug name info:",{currentLanguage:C,userName:ev,testId:P,originalName:eH,formattedName:ev}),(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-400 via-purple-500 to-purple-600 flex items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"w-full max-w-3xl",children:[(0,i.jsxs)("div",{className:"mb-8 text-center",children:[U&&O&&!$&&(0,i.jsxs)("div",{className:"mb-6 p-6 bg-pink-500/30 border border-pink-400/50 rounded-lg",children:[(0,i.jsxs)("h1",{className:"text-2xl font-bold text-white mb-4",children:["\uD83D\uDC95 ","ko"===C?"".concat(O,"님이 초대했습니다!"):"".concat(O," invited you!")]}),(0,i.jsx)("p",{className:"text-white/90 mb-6",children:"ko"===C?"시작하기 전에, 본인 확인을 위해 초대를 보낸 분의 이메일 주소를 입력해주세요:":"Before we start, please enter the email address of the person who invited you:"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"email",value:et,onChange:e=>es(e.target.value),placeholder:"ko"===C?"초대한 분의 이메일 (예: partner@example.com)":"Inviter's email address (e.g., partner@example.com)",className:"w-full p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-pink-400",onKeyPress:e=>"Enter"===e.key&&eV()})}),ei&&(0,i.jsx)("p",{className:"text-red-300 text-sm",children:ei}),(0,i.jsx)("button",{onClick:eV,className:"w-full py-3 bg-pink-500 hover:bg-pink-600 text-white font-semibold rounded-lg transition-colors duration-200",children:"ko"===C?"확인하고 테스트 시작":"Verify & Start Test"}),(0,i.jsx)("p",{className:"text-xs text-white/60 text-center",children:"ko"===C?"초대를 보낸 분의 정확한 이메일 주소를 입력해야 테스트를 시작할 수 있습니다":"You must enter the exact email address of the person who invited you to start the test"})]})]}),U&&O&&$&&!en&&(0,i.jsxs)("div",{className:"mb-6 p-4 bg-green-500/30 border border-green-400/50 rounded-lg",children:[(0,i.jsxs)("h1",{className:"text-2xl font-bold text-white mb-4",children:["✅ ","ko"===C?"이메일 확인 완료!":"Email Verified!"]}),(0,i.jsx)("p",{className:"text-white/90 mb-4",children:"ko"===C?"마지막으로, 결과 이메일 개인화를 위해 당신의 이름을 입력해주세요 (최소 2글자):":"Finally, please enter your name for personalized results email (minimum 2 characters):"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("input",{type:"text",value:eo,onChange:e=>er(e.target.value),placeholder:"ko"===C?"당신의 이름 (예: 김민수, Sarah)":"Your name (e.g., Sarah, Mike)",className:"flex-1 p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-green-400",onKeyPress:e=>{"Enter"===e.key&&eo.trim().length>=2&&(localStorage.setItem("couple_secondPartnerName",eo.trim()),el(!0))}}),(0,i.jsx)("button",{onClick:()=>{eo.trim().length>=2&&(localStorage.setItem("couple_secondPartnerName",eo.trim()),el(!0))},disabled:eo.trim().length<2,className:"px-4 py-3 bg-green-500 hover:bg-green-600 disabled:bg-gray-500 text-white font-semibold rounded-lg transition-colors duration-200",children:"ko"===C?"확인":"OK"})]}),eo.trim().length>0&&eo.trim().length<2&&(0,i.jsx)("p",{className:"text-yellow-300 text-xs",children:"ko"===C?"최소 2글자 필요 (현재 ".concat(eo.trim().length,"글자)"):"Minimum 2 characters required (current: ".concat(eo.trim().length,")")})]})]}),U&&O&&$&&en&&!ec&&(0,i.jsxs)("div",{className:"mb-6 p-6 bg-blue-500/30 border border-blue-400/50 rounded-lg",children:[(0,i.jsxs)("h1",{className:"text-2xl font-bold text-white mb-4",children:["\uD83D\uDE80 ","ko"===C?"환영합니다, ".concat(eo,"님!"):"Welcome, ".concat(eo,"!")]}),(0,i.jsx)("p",{className:"text-white/90 mb-6 text-lg",children:"ko"===C?"".concat(O,"님과의 커플 호환성을 테스트해보세요! 15개의 질문을 통해 당신들의 관계 호환성을 분석합니다."):"Let's test your compatibility with ".concat(O,"! We'll analyze your relationship compatibility through 15 questions.")}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("button",{onClick:()=>ed(!0),className:"px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white font-bold text-lg rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:"ko"===C?"\uD83D\uDC95 테스트 시작하기":"\uD83D\uDC95 Start Compatibility Test"}),(0,i.jsx)("p",{className:"text-white/70 text-sm mt-3",children:"ko"===C?"약 5-10분이 소요됩니다":"Takes about 5-10 minutes"})]})]}),"couple-compatibility"===P&&!U&&!ec&&(0,i.jsxs)("div",{className:"mb-6 p-6 bg-gradient-to-br from-purple-500/30 to-pink-500/30 border border-purple-400/50 rounded-lg",children:[(0,i.jsxs)("h1",{className:"text-2xl font-bold text-white mb-4 text-center",children:["\uD83D\uDC95 ","ko"===C?"커플 호환성 테스트":"Couple Compatibility Test"]}),(0,i.jsx)("p",{className:"text-white/90 mb-6 text-lg text-center",children:"ko"===C?"15개의 질문을 통해 당신과 파트너의 관계 호환성을 분석합니다.":"Analyze your relationship compatibility through 15 questions."}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("button",{onClick:()=>ed(!0),className:"px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white font-bold text-lg rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:"ko"===C?"\uD83D\uDC95 테스트 시작하기":"\uD83D\uDC95 Start Compatibility Test"}),(0,i.jsx)("p",{className:"text-white/70 text-sm mt-3",children:"ko"===C?"약 5-10분이 소요됩니다":"Takes about 5-10 minutes"})]})]}),("couple-compatibility"!==P||ec)&&(!U||$&&en&&ec)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold mb-4 text-white","data-translate":B.title_key,children:S(B.title_key)||B.title_key}),(0,i.jsx)("div",{className:"w-full bg-white/20 backdrop-blur-sm rounded-full h-3 mb-2",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-yellow-300 to-orange-400 h-3 rounded-full transition-all duration-500",style:{width:"".concat((z+1)/B.questions.length*100,"%")}})}),(0,i.jsxs)("p",{className:"text-white/80 text-sm",children:["Question ",z+1," of ",B.questions.length]}),eB&&["general-knowledge","math-speed"].includes(B.id)&&(0,i.jsxs)("div",{className:"mt-4 text-center",children:[(0,i.jsxs)("div",{className:"inline-flex items-center px-4 py-2 rounded-full ".concat(eG<=3?"bg-red-500/30 border-red-400":"bg-blue-500/30 border-blue-400"," border backdrop-blur-sm"),children:[(0,i.jsx)("span",{className:"text-2xl mr-2",children:"⏰"}),(0,i.jsxs)("span",{className:"text-lg font-bold ".concat(eG<=3?"text-red-300":"text-blue-300"),children:[eG,"s"]})]}),"math-speed"===B.id&&(0,i.jsx)("p",{className:"text-white/60 text-xs mt-1",children:"ko"===C?"응답 시간이 기록됩니다":"Response time is being recorded"})]})]})]}),("couple-compatibility"!==P||ec)&&(!U||$&&en&&ec)&&(0,i.jsxs)("div",{className:"p-8 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg shadow-lg",children:[eO&&eL.length>0?(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("h2",{className:"mb-6 text-2xl font-semibold tracking-tight text-white",children:["\uD83E\uDDE0 ","ko"===C?"다음 항목들을 기억하세요:":"Memorize the following items:"]}),(0,i.jsx)("div",{className:"mb-8 p-6 bg-white/10 rounded-lg border-2 border-yellow-300/50",children:(0,i.jsx)("div",{className:"flex flex-col gap-3 text-xl text-white font-medium max-w-md mx-auto",children:eL.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center p-4 bg-white/10 rounded-lg",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-yellow-500 text-black font-bold rounded-full flex items-center justify-center text-lg mr-4",children:t+1}),(0,i.jsx)("div",{className:"flex-1 text-left",children:e})]},t))})}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-4xl font-bold text-yellow-300 mb-2",children:eU}),(0,i.jsx)("p",{className:"text-white/80",children:"ko"===C?"초 남음":"seconds remaining"})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mb-8 text-center",children:[("spirit-animal"===P||"country-match"===P||"mental-age"===P)&&(0,i.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500/30 to-pink-500/30 backdrop-blur-sm rounded-full border border-white/20 mb-6",children:[(0,i.jsx)("span",{className:"text-2xl animate-pulse",children:"spirit-animal"===P?"\uD83E\uDD8B":"country-match"===P?"\uD83C\uDF0D":"\uD83E\uDDE0"}),(0,i.jsx)("span",{className:"text-sm font-medium text-gray-100",children:"spirit-animal"===P?S("tests.spirit_animal.title")||"Spirit Animal Discovery":"country-match"===P?S("tests.country_match.title")||"Country Match":"mental-age"===P?S("tests.mental_age.title")||"Mental Age":"Personality Discovery"})]}),(0,i.jsx)("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-50 leading-relaxed tracking-tight mb-4 px-4 text-enhanced max-w-4xl mx-auto",children:(()=>{if("feedback-360"===P&&ev){let e=S(tN.text_key);return e&&e!==tN.text_key||(e=tN.text_key),console.log("Debug translation:",{key:tN.text_key,translatedText:e,currentLanguage:C,userName:ev}),e.replace(/\[NAME\]/g,ev)}return S(tN.text_key)||tN.text_key})()}),(0,i.jsx)("p",{className:"text-gray-200 text-sm font-medium text-enhanced",children:S("ui.chooseOptionBelow")||"Choose the option that resonates most with you"})]}),"multiple_choice"===tN.type&&tN.options&&!eO&&(0,i.jsx)("div",{className:"grid gap-5 md:gap-6",children:tN.options.map((e,t)=>{let s=["✨","\uD83C\uDF1F","\uD83D\uDCAB","⭐"],a=["from-rose-400 to-pink-500","from-violet-400 to-purple-500","from-blue-400 to-indigo-500","from-emerald-400 to-teal-500"];return["spirit-animal","mental-age","country-match"].includes(P)&&console.log("\uD83D\uDD0D ".concat(P.toUpperCase()," Rendering Option ").concat(t,":"),{value:e.value,text_key:e.text_key,questionId:tN.id}),(0,i.jsxs)("button",{onClick:()=>tg(e.value),className:"group relative w-full p-7 md:p-8 text-left bg-black/20 backdrop-blur-xl border border-white/20 rounded-2xl hover:bg-black/30 transition-all duration-500 transform hover:scale-[1.02] hover:shadow-2xl text-white overflow-hidden","data-translate":e.text_key,"data-option-id":"".concat(tN.id,"-").concat(e.value),children:[(0,i.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-500 bg-gradient-to-br ".concat(a[t%a.length])}),(0,i.jsxs)("div",{className:"relative z-10 flex items-start gap-5",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-14 h-14 bg-gradient-to-br ".concat(a[t%a.length]," rounded-2xl flex items-center justify-center text-white font-bold text-xl shadow-lg group-hover:shadow-xl transition-all duration-300 mt-1"),children:String.fromCharCode(65+t)}),(0,i.jsx)("div",{className:"flex-1 py-2",children:(0,i.jsx)("p",{className:"text-gray-100 font-medium text-lg md:text-xl leading-relaxed group-hover:text-white transition-colors duration-300 tracking-wide text-enhanced",children:S(e.text_key)||e.text_key})}),(0,i.jsx)("div",{className:"flex-shrink-0 text-3xl opacity-60 group-hover:opacity-100 group-hover:scale-110 transition-all duration-300 mt-2",children:s[t%s.length]})]}),(0,i.jsx)("div",{className:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none",children:(0,i.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r ".concat(a[t%a.length]," opacity-20")})})]},"".concat(tN.id,"-").concat(e.value,"-").concat(t))})},"options-".concat(tN.id)),"scale"===tN.type&&tN.scale&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm text-white/80",children:[(0,i.jsx)("span",{"data-translate":tN.scale.minLabel_key,children:S(tN.scale.minLabel_key)||tN.scale.minLabel_key}),(0,i.jsx)("span",{"data-translate":tN.scale.maxLabel_key,children:S(tN.scale.maxLabel_key)||tN.scale.maxLabel_key})]}),(0,i.jsx)("div",{className:"flex justify-between gap-2",children:Array.from({length:tN.scale.max-tN.scale.min+1},(e,t)=>{let s=tN.scale.min+t;return(0,i.jsx)("button",{onClick:()=>tg(s),className:"flex-1 py-3 text-center bg-white/20 backdrop-blur-sm border border-white/30 rounded hover:bg-white/30 hover:scale-105 transition-all duration-300 text-white font-semibold",children:s},s)})})]})]}),(0,i.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,i.jsxs)("div",{className:"flex gap-3",children:[z>0&&(0,i.jsxs)("button",{onClick:()=>{let e=z-1;W(e),tm(e,J)},disabled:eO,className:"px-4 py-2 backdrop-blur-sm border border-white/30 text-white rounded-lg transition-all duration-300 ".concat(eO?"bg-white/5 opacity-50 cursor-not-allowed":"bg-white/10 hover:bg-white/20"),children:["← ",S("ui.previous")||"Previous"]}),(0,i.jsxs)("button",{onClick:()=>{tm(z,J),_.push("/".concat(C,"/tests"))},disabled:eO,className:"px-6 py-2 font-semibold rounded-lg transition-all duration-300 ".concat(eO?"bg-gray-500 text-white/50 cursor-not-allowed opacity-50":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 transform hover:scale-105"),children:["\uD83D\uDCBE ",S("ui.saveExit")||"Save & Exit"]})]}),(0,i.jsxs)("div",{className:"text-white/70 text-sm text-center",children:[(0,i.jsx)("p",{className:"mb-1",children:S("ui.progressSaved")||"Progress automatically saved"}),(0,i.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,i.jsx)("span",{children:S("ui.answersSaved")||"Your answers are being saved"})]})]})]})]})]})})}},7200:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,AuthProvider:()=>m});var i=s(5155),a=s(2115),o=s(5404),r=s(5695),n=s(6104),l=s(9086);let c=(0,a.createContext)(void 0),d=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},m=e=>{let{children:t}=e,[s,d]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),h=(0,r.useRouter)();return(0,a.useEffect)(()=>{let e=(0,o.hg)(n.j,async e=>{if(e){if(!e.providerData.some(e=>"google.com"===e.providerId)&&!e.emailVerified){console.log("\uD83D\uDEA8 AuthProvider: Blocking unverified email user:",e.email),console.log("\uD83D\uDCE7 Email verification status:",e.emailVerified),await (0,o.CI)(n.j),d(null),u(!1);return}console.log("✅ AuthProvider: User verified, proceeding:",e.email);try{await (0,l.sM)(e)}catch(e){console.warn("Firebase permissions issue - continuing without profile creation:",e)}if(!s&&e){let t=localStorage.getItem("auth_return_url"),s=localStorage.getItem("auth_return_context");if(t&&("feedback-360-test"===s||"couple-compatibility-test"===s)){localStorage.removeItem("auth_return_url"),localStorage.removeItem("auth_return_context"),console.log("User logged in, preparing greeting before ".concat(s));let i=t.match(/\/([a-z]{2})\//),a=i?i[1]:"en";setTimeout(()=>{h.push("/".concat(a,"/welcome?returnUrl=").concat(encodeURIComponent(t),"&context=").concat(s,"&userName=").concat(encodeURIComponent(e.displayName||e.email||"User")))},100)}}}d(e),u(!1)});return()=>e()},[s,h]),(0,i.jsx)(c.Provider,{value:{user:s,loading:m},children:!m&&t})}}},e=>{e.O(0,[135,965,155,761,550,86,722,441,964,358],()=>e(e.s=707)),_N_E=e.O()}]);