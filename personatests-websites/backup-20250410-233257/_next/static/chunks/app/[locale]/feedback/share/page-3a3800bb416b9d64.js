(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[925],{5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},7357:(e,t,s)=>{Promise.resolve().then(s.bind(s,9875))},9875:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2115),i=s(5695),n=s(7550),l=s(3722);function d(){let{t:e}=(0,n.B)(),t=(0,i.useSearchParams)(),s=t.get("linkId"),d=t.get("data"),[o,c]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[m,b]=(0,r.useState)(!0),[x,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(0),[k,w]=(0,r.useState)({}),[j,N]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{I()},[s,d]);let I=async()=>{if(d)try{let e=JSON.parse(atob(d));if(new Date(e.expiresAt)<=new Date){f("This feedback link has expired."),b(!1);return}let t={id:"link_".concat(e.testResultId,"_decoded"),testResultId:e.testResultId,testId:e.testId,userId:e.userId,userName:e.userName,method:"link",createdAt:e.createdAt,expiresAt:e.expiresAt,status:"active",link:window.location.href,linkId:"link_".concat(e.testResultId,"_decoded"),responseCount:0,maxResponses:e.maxResponses,isPublic:!0};if(JSON.parse(localStorage.getItem("submitted_link_feedback")||"[]").some(t=>t.testResultId===e.testResultId&&t.testId===e.testId)){f("You have already provided feedback for this person."),b(!1);return}c(t);let s=(0,l.tb)(e.testId);if(!s){f("Test not found"),b(!1);return}h(s),b(!1);return}catch(e){f("Invalid feedback link format."),b(!1);return}if(!s){f("Invalid feedback link"),b(!1);return}try{let e=JSON.parse(localStorage.getItem("shareable_links")||"[]").find(e=>e.linkId===s&&"active"===e.status&&new Date(e.expiresAt)>new Date);if(!e){f("This feedback link is invalid or has expired."),b(!1);return}if(e.maxResponses&&e.responseCount>=e.maxResponses){f("This feedback link has reached its maximum response limit."),b(!1);return}if(JSON.parse(localStorage.getItem("submitted_link_feedback")||"[]").some(e=>e.linkId===s)){f("You have already provided feedback using this link."),b(!1);return}c(e);let t=(0,l.tb)(e.testId);if(!t){f("Test not found"),b(!1);return}h(t)}catch(e){f("Failed to load feedback form. Please try again.")}finally{b(!1)}},S=e=>{if(!u)return;let t=u.questions[p],s={...k,[t.id]:e};w(s),p<u.questions.length-1?g(p+1):_(s)},_=async e=>{if(o&&u){N(!0);try{let t=u.scoring(e),a={id:"link_feedback_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,8)),testResultId:o.testResultId,testId:o.testId,testOwnerId:o.userId,answers:e,result:t,submittedAt:new Date().toISOString(),method:"link",linkId:o.linkId,shareableLink:o.link},r=JSON.parse(localStorage.getItem("feedback_responses")||"[]");r.push(a),localStorage.setItem("feedback_responses",JSON.stringify(r));let i=JSON.parse(localStorage.getItem("submitted_link_feedback")||"[]");i.push({linkId:o.linkId,submittedAt:new Date().toISOString()}),localStorage.setItem("submitted_link_feedback",JSON.stringify(i));let n=JSON.parse(localStorage.getItem("shareable_links")||"[]").map(e=>e.linkId===s?{...e,responseCount:e.responseCount+1}:e);localStorage.setItem("shareable_links",JSON.stringify(n)),y(!0)}catch(e){f("Failed to submit feedback. Please try again.")}finally{N(!1)}}};if(m)return(0,a.jsx)("main",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-lg text-white",children:"Loading feedback form..."})]})});if(x)return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full text-center p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"❌"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Unable to Load Feedback"}),(0,a.jsx)("p",{className:"text-white/80 mb-6",children:x}),(0,a.jsx)("div",{className:"text-white/60 text-sm",children:(0,a.jsx)("p",{children:"Please check the link and try again, or contact the person who shared it."})})]})});if(v)return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full text-center p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"✅"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Feedback Submitted!"}),(0,a.jsxs)("p",{className:"text-white/80 mb-6",children:["Thank you for providing anonymous feedback for ",null==o?void 0:o.userName,". Your insights will help with their personal and professional growth."]}),(0,a.jsxs)("div",{className:"text-white/60 text-sm",children:[(0,a.jsx)("p",{children:"• Your response is completely anonymous"}),(0,a.jsx)("p",{children:"• Results will be shared as aggregated insights"}),(0,a.jsx)("p",{children:"• No individual responses can be traced back"})]})]})});if(!u||!o)return(0,a.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-lg",children:"Loading..."})]})});let P=u.questions[p],R=(p+1)/u.questions.length*100;return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-sm border border-white/30 rounded-full text-white/80 text-sm mb-4",children:(0,a.jsx)("span",{children:"\uD83D\uDD17 Shared Feedback Link"})}),(0,a.jsxs)("h1",{className:"text-2xl font-bold text-white mb-2",children:["Anonymous Feedback for ",o.userName]}),(0,a.jsx)("p",{className:"text-white/80",children:"Your honest feedback will help with personal and professional growth"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between text-white/80 text-sm mb-2",children:[(0,a.jsxs)("span",{children:["Question ",p+1," of ",u.questions.length]}),(0,a.jsxs)("span",{children:[Math.round(R),"% Complete"]})]}),(0,a.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(R,"%")}})})]}),(0,a.jsxs)("div",{className:"p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-6 text-center",children:e(P.text_key)}),"multiple_choice"===P.type&&P.options&&(0,a.jsx)("div",{className:"space-y-3",children:P.options.map(t=>(0,a.jsx)("button",{onClick:()=>S(t.value),className:"w-full p-4 text-left bg-white/20 hover:bg-white/30 border border-white/30 rounded-lg text-white transition-all duration-300 hover:scale-[1.02]",children:e(t.text_key)},t.value.toString()))}),"scale"===P.type&&P.scale&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-white/80 text-sm",children:[(0,a.jsx)("span",{children:e(P.scale.minLabel_key)}),(0,a.jsx)("span",{children:e(P.scale.maxLabel_key)})]}),(0,a.jsx)("div",{className:"flex gap-2 justify-center",children:Array.from({length:P.scale.max-P.scale.min+1},(e,t)=>(0,a.jsx)("button",{onClick:()=>S(P.scale.min+t),className:"w-12 h-12 bg-white/20 hover:bg-white/30 border border-white/30 rounded-lg text-white font-bold transition-all duration-300 hover:scale-110",children:P.scale.min+t},t))})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,a.jsx)("button",{onClick:()=>{p>0&&g(p-1)},disabled:0===p,className:"px-6 py-3 bg-white/20 hover:bg-white/30 disabled:bg-white/10 disabled:text-white/50 text-white rounded-lg transition-all duration-300",children:"← Previous"}),(0,a.jsx)("div",{className:"flex items-center text-white/60 text-sm",children:"Anonymous Response"})]})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-green-500/20 border border-green-400 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold text-white mb-2",children:"\uD83D\uDD12 Your Privacy is Protected"}),(0,a.jsxs)("div",{className:"text-white/80 text-sm space-y-1",children:[(0,a.jsx)("p",{children:"• Your responses are completely anonymous"}),(0,a.jsx)("p",{children:"• No personal information is collected or stored"}),(0,a.jsx)("p",{children:"• Results are aggregated with other feedback"}),(0,a.jsx)("p",{children:"• Individual responses cannot be traced back to you"})]})]}),j&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg p-6 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-white",children:"Submitting your anonymous feedback..."})]})})]})})}}},e=>{e.O(0,[550,722,441,964,358],()=>e(e.s=7357)),_N_E=e.O()}]);