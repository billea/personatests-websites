(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[551],{3669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2115),i=s(5695),l=s(7550),n=s(3722);function d(){let{t:e}=(0,l.B)(),t=(0,i.useSearchParams)(),[s,d]=(0,r.useState)(t.get("code")||""),[o,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[h,b]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[p,f]=(0,r.useState)(0),[w,j]=(0,r.useState)({}),[N,v]=(0,r.useState)(!1),[y,k]=(0,r.useState)(!1),S=async()=>{if(!s||8!==s.length)return void g("Please enter a valid 8-character code");b(!0),g(null);try{let e=JSON.parse(localStorage.getItem("anonymous_codes")||"[]").find(e=>e.code===s.toUpperCase()&&"active"===e.status&&new Date(e.expiresAt)>new Date);if(!e)return void g("Invalid or expired code. Please check the code and try again.");if(JSON.parse(localStorage.getItem("submitted_code_feedback")||"[]").some(t=>t.codeUsed===e.code))return void g("You have already provided feedback using this code.");c(e);let t=(0,n.tb)(e.testId);if(!t)return void g("Test not found");m(t)}catch(e){g("Failed to validate code. Please try again.")}finally{b(!1)}},_=e=>{if(!u)return;let t=u.questions[p],s={...w,[t.id]:e};j(s),p<u.questions.length-1?f(p+1):I(s)},I=async e=>{if(o&&u){v(!0);try{let t=u.scoring(e),s={id:"code_feedback_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,8)),testResultId:o.testResultId,testId:o.testId,testOwnerId:o.userId,answers:e,result:t,submittedAt:new Date().toISOString(),method:"codes",codeUsed:o.code,codeId:o.id},a=JSON.parse(localStorage.getItem("feedback_responses")||"[]");a.push(s),localStorage.setItem("feedback_responses",JSON.stringify(a));let r=JSON.parse(localStorage.getItem("submitted_code_feedback")||"[]");r.push({codeUsed:o.code,codeId:o.id,submittedAt:new Date().toISOString()}),localStorage.setItem("submitted_code_feedback",JSON.stringify(r));let i=JSON.parse(localStorage.getItem("anonymous_codes")||"[]").map(e=>e.id===o.id?{...e,usageCount:e.usageCount+1,lastUsedAt:new Date().toISOString()}:e);localStorage.setItem("anonymous_codes",JSON.stringify(i)),k(!0)}catch(e){g("Failed to submit feedback. Please try again.")}finally{v(!1)}}};if((0,r.useEffect)(()=>{let e=t.get("code");e&&8===e.length&&(d(e.toUpperCase()),S())},[]),y)return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full text-center p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"✅"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Feedback Submitted!"}),(0,a.jsx)("p",{className:"text-white/80 mb-6",children:"Thank you for providing anonymous feedback. Your insights will help with personal and professional growth."}),(0,a.jsxs)("div",{className:"text-white/60 text-sm",children:[(0,a.jsx)("p",{children:"• Your response is completely anonymous"}),(0,a.jsx)("p",{children:"• Results will be shared as aggregated insights"}),(0,a.jsx)("p",{children:"• No individual responses can be traced back"})]})]})});if(!o)return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"\uD83D\uDD11 Enter Feedback Code"}),(0,a.jsx)("p",{className:"text-white/80 text-sm",children:"Enter the 8-character code you received to provide anonymous feedback"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Feedback Code"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>d(e.target.value.toUpperCase()),placeholder:"Enter code (e.g. AB123XYZ)",maxLength:8,className:"w-full p-4 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white text-center text-lg font-mono placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-white/50",onKeyPress:e=>{"Enter"===e.key&&8===s.length&&S()}}),(0,a.jsx)("p",{className:"text-white/60 text-xs mt-2",children:"Code should be exactly 8 characters (letters and numbers)"})]}),x&&(0,a.jsx)("div",{className:"p-3 bg-red-500/20 border border-red-400 rounded-lg",children:(0,a.jsx)("p",{className:"text-red-400 text-sm",children:x})}),(0,a.jsx)("button",{onClick:S,disabled:h||8!==s.length,className:"w-full p-4 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-500/50 text-white font-bold rounded-lg transition-colors duration-300 flex items-center justify-center gap-2",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Validating..."]}):(0,a.jsx)(a.Fragment,{children:"\uD83D\uDD0D Validate Code & Start Feedback"})})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-500/20 border border-blue-400 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold text-white mb-2",children:"\uD83D\uDCF1 Privacy Notice"}),(0,a.jsxs)("div",{className:"text-white/80 text-sm space-y-1",children:[(0,a.jsx)("p",{children:"• Your feedback is completely anonymous"}),(0,a.jsx)("p",{children:"• No email or personal information required"}),(0,a.jsx)("p",{children:"• Responses are aggregated with others"}),(0,a.jsx)("p",{children:"• Individual answers cannot be traced back to you"})]})]})]})});if(!u)return(0,a.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-lg",children:"Loading feedback form..."})]})});let C=u.questions[p],D=(p+1)/u.questions.length*100;return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between text-white/80 text-sm mb-2",children:[(0,a.jsxs)("span",{children:["Question ",p+1," of ",u.questions.length]}),(0,a.jsxs)("span",{children:[Math.round(D),"% Complete"]})]}),(0,a.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(D,"%")}})})]}),(0,a.jsxs)("div",{className:"p-8 bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsxs)("p",{className:"text-white/60 text-sm mb-2",children:["Anonymous feedback for ",o.userName]}),(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:e(C.text_key)})]}),"multiple_choice"===C.type&&C.options&&(0,a.jsx)("div",{className:"space-y-3",children:C.options.map(t=>(0,a.jsx)("button",{onClick:()=>_(t.value),className:"w-full p-4 text-left bg-white/20 hover:bg-white/30 border border-white/30 rounded-lg text-white transition-all duration-300",children:e(t.text_key)},t.value.toString()))}),"scale"===C.type&&C.scale&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-white/80 text-sm",children:[(0,a.jsx)("span",{children:e(C.scale.minLabel_key)}),(0,a.jsx)("span",{children:e(C.scale.maxLabel_key)})]}),(0,a.jsx)("div",{className:"flex gap-2 justify-center",children:Array.from({length:C.scale.max-C.scale.min+1},(e,t)=>(0,a.jsx)("button",{onClick:()=>_(C.scale.min+t),className:"w-12 h-12 bg-white/20 hover:bg-white/30 border border-white/30 rounded-lg text-white font-bold transition-all duration-300",children:C.scale.min+t},t))})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,a.jsx)("button",{onClick:()=>{p>0&&f(p-1)},disabled:0===p,className:"px-6 py-3 bg-white/20 hover:bg-white/30 disabled:bg-white/10 disabled:text-white/50 text-white rounded-lg transition-all duration-300",children:"← Previous"}),(0,a.jsxs)("div",{className:"flex items-center text-white/60 text-sm",children:["Code: ",(0,a.jsx)("code",{className:"ml-2 bg-white/20 px-2 py-1 rounded font-mono",children:o.code})]})]})]}),N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm border border-white/30 rounded-lg p-6 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-white",children:"Submitting your anonymous feedback..."})]})})]})})}},5561:(e,t,s)=>{Promise.resolve().then(s.bind(s,3669))},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{e.O(0,[550,722,441,964,358],()=>e(e.s=5561)),_N_E=e.O()}]);