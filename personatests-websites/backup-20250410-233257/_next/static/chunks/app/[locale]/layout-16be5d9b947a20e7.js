(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{773:(e,t,r)=>{Promise.resolve().then(r.bind(r,4615)),Promise.resolve().then(r.bind(r,7200)),Promise.resolve().then(r.bind(r,7550))},4615:(e,t,r)=>{"use strict";r.d(t,{default:()=>x});var o=r(5155),s=r(6874),n=r.n(s),l=r(5695),a=r(7550),c=r(7200),i=r(5404),d=r(6104),u=r(2115),p=r(9086);function x(){var e;let t=(0,l.usePathname)(),r=(0,l.useRouter)(),{t:s,currentLanguage:x}=(0,a.B)(),{user:m,loading:h}=(0,c.A)(),[g,f]=(0,u.useState)(!1),[v,b]=(0,u.useState)(!1),[y,j]=(0,u.useState)([]),[k,N]=(0,u.useState)(!1),w=t.split("/")[1]||"en";(0,u.useEffect)(()=>{(async()=>{try{let e=await (0,p.rc)();j(e)}catch(e){console.error("Error loading enabled languages:",e),j([{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8",isEnabled:!0,isDefault:!0,completionPercentage:100,lastUpdated:new Date}])}})()},[]),(0,u.useEffect)(()=>{(async()=>{if(m&&!h)try{let e=await (0,p.N6)(m.uid);N(e)}catch(e){console.error("Error checking admin role:",e),N(!1)}else N(!1)})()},[m,h]);let C=async()=>{try{await (0,i.CI)(d.j),console.log("User signed out successfully"),r.push("/".concat(w))}catch(e){console.error("Error signing out:",e)}},E=y.find(e=>e.code===x)||y.find(e=>e.isDefault)||y[0]||{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"};return h?null:(0,o.jsxs)("header",{className:"bg-white/95 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:[(0,o.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,o.jsx)("div",{className:"flex items-center",children:(0,o.jsxs)(n(),{href:"/".concat(w),className:"text-xl font-bold text-purple-600 hover:text-purple-700 transition-colors flex items-center",children:[(0,o.jsx)("span",{className:"mr-2",children:"✨"}),"ko"===x?"성격테스트":"PersonaTests"]})}),(0,o.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,o.jsx)(n(),{href:"/".concat(w),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg ".concat(t==="/".concat(w)||"/"===t?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"홈":"Home"}),(0,o.jsx)(n(),{href:"/".concat(w,"/tests"),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg ".concat(t.includes("/tests")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"테스트":"Tests"}),(0,o.jsx)(n(),{href:"/".concat(w,"/results"),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg ".concat(t.includes("/results")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"결과":"Results"}),(0,o.jsx)(n(),{href:"/".concat(w,"/contact"),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg ".concat(t.includes("/contact")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"문의하기":"Contact"}),m&&(0,o.jsx)(n(),{href:"/".concat(w,"/profile"),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg ".concat(t.includes("/profile")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"프로필":"Profile"}),m&&k&&(0,o.jsxs)(n(),{href:"/".concat(w,"/admin"),className:"text-sm font-medium transition-colors px-3 py-2 rounded-lg border-2 border-orange-200 ".concat(t.includes("/admin")?"text-orange-700 bg-orange-50 border-orange-300":"text-orange-600 hover:text-orange-700 hover:bg-orange-50 hover:border-orange-300"),children:["⚙️ ","ko"===x?"관리":"Admin"]})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsxs)("button",{onClick:()=>b(!v),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-600 hover:text-purple-600 hover:bg-gray-50 rounded-lg transition-colors",children:[(0,o.jsx)("span",{children:E.flag}),(0,o.jsx)("span",{className:"hidden sm:block",children:E.code.toUpperCase()}),(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),v&&(0,o.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:y.map(e=>(0,o.jsxs)("button",{onClick:()=>{var t;return t=e.code,void(r.push("/".concat(t)),b(!1))},className:"w-full text-left px-4 py-2 text-sm hover:bg-purple-50 flex items-center space-x-3 ".concat(x===e.code?"text-purple-600 bg-purple-50":"text-gray-700"),children:[(0,o.jsx)("span",{children:e.flag}),(0,o.jsx)("span",{children:e.name})]},e.code))})]}),m?(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsxs)("div",{className:"hidden sm:block text-right",children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"ko"===x?"안녕하세요!":"Hello!"}),(0,o.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:m.displayName||(null==(e=m.email)?void 0:e.split("@")[0])||"User"})]}),(0,o.jsxs)("button",{onClick:C,className:"flex items-center space-x-2 bg-purple-50 hover:bg-purple-100 px-3 py-2 rounded-full transition-colors group",title:"ko"===x?"로그아웃":"Sign out",children:[m.photoURL?(0,o.jsx)("img",{src:m.photoURL,alt:"Profile",className:"w-8 h-8 rounded-full"}):(0,o.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:(m.displayName||m.email||"U")[0].toUpperCase()}),(0,o.jsx)("span",{className:"hidden sm:block text-xs text-gray-500 group-hover:text-purple-600",children:"ko"===x?"로그아웃":"Sign out"})]})]}):(0,o.jsx)(n(),{href:"/".concat(w,"/auth"),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"ko"===x?"로그인":"Sign In"}),(0,o.jsx)("button",{onClick:()=>f(!g),className:"md:hidden p-2 text-gray-600 hover:text-purple-600 hover:bg-gray-50 rounded-lg transition-colors",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g?(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),g&&(0,o.jsx)("div",{className:"md:hidden border-t border-gray-200 py-4",children:(0,o.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,o.jsx)(n(),{href:"/".concat(w),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(t==="/".concat(w)||"/"===t?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"홈":"Home"}),(0,o.jsx)(n(),{href:"/".concat(w,"/tests"),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(t.includes("/tests")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"테스트":"Tests"}),(0,o.jsx)(n(),{href:"/".concat(w,"/results"),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(t.includes("/results")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"결과":"Results"}),(0,o.jsx)(n(),{href:"/".concat(w,"/contact"),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(t.includes("/contact")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"문의하기":"Contact"}),m&&(0,o.jsx)(n(),{href:"/".concat(w,"/profile"),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(t.includes("/profile")?"text-purple-600 bg-purple-50":"text-gray-600 hover:text-purple-600 hover:bg-gray-50"),children:"ko"===x?"프로필":"Profile"}),m&&k&&(0,o.jsxs)(n(),{href:"/".concat(w,"/admin"),onClick:()=>f(!1),className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors border-2 border-orange-200 ".concat(t.includes("/admin")?"text-orange-700 bg-orange-50 border-orange-300":"text-orange-600 hover:text-orange-700 hover:bg-orange-50 hover:border-orange-300"),children:["⚙️ ","ko"===x?"관리":"Admin"]})]})})]}),v&&(0,o.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>b(!1)})]})}},7200:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>u});var o=r(5155),s=r(2115),n=r(5404),l=r(5695),a=r(6104),c=r(9086);let i=(0,s.createContext)(void 0),d=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},u=e=>{let{children:t}=e,[r,d]=(0,s.useState)(null),[u,p]=(0,s.useState)(!0),x=(0,l.useRouter)();return(0,s.useEffect)(()=>{let e=(0,n.hg)(a.j,async e=>{if(e){if(!e.providerData.some(e=>"google.com"===e.providerId)&&!e.emailVerified){console.log("\uD83D\uDEA8 AuthProvider: Blocking unverified email user:",e.email),console.log("\uD83D\uDCE7 Email verification status:",e.emailVerified),await (0,n.CI)(a.j),d(null),p(!1);return}console.log("✅ AuthProvider: User verified, proceeding:",e.email);try{await (0,c.sM)(e)}catch(e){console.warn("Firebase permissions issue - continuing without profile creation:",e)}if(!r&&e){let t=localStorage.getItem("auth_return_url"),r=localStorage.getItem("auth_return_context");if(t&&("feedback-360-test"===r||"couple-compatibility-test"===r)){localStorage.removeItem("auth_return_url"),localStorage.removeItem("auth_return_context"),console.log("User logged in, preparing greeting before ".concat(r));let o=t.match(/\/([a-z]{2})\//),s=o?o[1]:"en";setTimeout(()=>{x.push("/".concat(s,"/welcome?returnUrl=").concat(encodeURIComponent(t),"&context=").concat(r,"&userName=").concat(encodeURIComponent(e.displayName||e.email||"User")))},100)}}}d(e),p(!1)});return()=>e()},[r,x]),(0,o.jsx)(i.Provider,{value:{user:r,loading:u},children:!u&&t})}}},e=>{e.O(0,[135,965,155,761,244,550,86,441,964,358],()=>e(e.s=773)),_N_E=e.O()}]);